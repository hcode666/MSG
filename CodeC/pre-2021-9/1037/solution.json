["import sys\n\ndef Max_R(i):\n    return len(R[i])\n\ndef Max_C(i):\n    return len(C[i])\nT = int(sys.stdin.readline())\nAns = ''\nfor t in range(T):\n    R = {}\n    C = {}\n    N = int(sys.stdin.readline())\n    ans = 0\n    for i in range(N):\n        (x, y) = map(int, sys.stdin.readline().split())\n        if x in R:\n            R[x] += [y]\n        else:\n            R[x] = [y]\n        if y in C:\n            C[y] += [x]\n        else:\n            C[y] = [x]\n    while N > 0:\n        ans += 1\n        x = sorted(R, key=Max_R, reverse=True)\n        y = sorted(C, key=Max_C, reverse=True)\n        xx = False\n        ix = 0\n        iy = 0\n        yy = False\n        for i in range(len(R)):\n            X = R[x[i]]\n            for item in X:\n                if len(C[item]) == 1:\n                    xx = True\n                    ix = x[i]\n                    break\n            if xx == True:\n                break\n        for i in range(len(C)):\n            Y = C[y[i]]\n            for item in Y:\n                if len(R[item]) == 1:\n                    iy = y[i]\n                    yy = True\n                    break\n            if yy == True:\n                break\n        if xx == True:\n            N -= len(X)\n            for item in X:\n                C[item].remove(ix)\n                if C[item] == []:\n                    del C[item]\n            del R[ix]\n        elif yy == True:\n            N -= len(Y)\n            for item in Y:\n                R[item].remove(iy)\n                if R[item] == []:\n                    del R[item]\n            del C[iy]\n        else:\n            ans += min(len(R), len(C)) - 1\n            break\n    Ans += str(ans) + '\\n'\nsys.stdout.write(Ans)"]