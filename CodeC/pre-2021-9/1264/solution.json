["mod = 998244353\n\ndef power(a, b):\n    if b == 0:\n        return 1\n    if b == 1:\n        return a\n    temp = power(a, int(b / 2)) % mod\n    if b % 2 == 0:\n        return temp % mod * (temp % mod) % mod\n    else:\n        return temp % mod * (a % mod) % mod * (temp % mod) % mod\nMaxW = 500005\n\ndef comp_exp_gcd(w, n):\n    c = [0] * (MaxW + 1)\n    d = [0] * (MaxW + 1)\n    e = [0] * (MaxW + 1)\n    for i in w:\n        c[i] += 1\n    for i in range(1, MaxW + 1):\n        for j in range(2 * i, MaxW + 1, i):\n            c[i] += c[j]\n    ans = 0\n    for i in range(MaxW, 0, -1):\n        d[i] = c[i] * c[i]\n        for j in range(2 * i, MaxW + 1, i):\n            d[i] -= d[j]\n        ans = (ans + i * d[i]) % mod\n    inv = power(n, mod - 2) % mod\n    print(ans * (n + 1) % mod * (2 * n + 1) % mod * power(6, mod - 2) % mod * inv * inv % mod)\nt = int(input())\nwhile t > 0:\n    n = int(input())\n    str = input().split(' ')\n    w = []\n    for i in str:\n        w.append(int(i))\n    exp_gcd = comp_exp_gcd(w, n)\n    t -= 1", "mod = 998244353\n\ndef power(a, b):\n    if b == 0:\n        return 1\n    if b == 1:\n        return a\n    temp = power(a, int(b / 2)) % mod\n    if b % 2 == 0:\n        return temp % mod * (temp % mod) % mod\n    else:\n        return temp % mod * (a % mod) % mod * (temp % mod) % mod\nMaxW = 500005\n\ndef comp_exp_gcd(w, n):\n    c = [0] * (MaxW + 1)\n    d = [0] * (MaxW + 1)\n    e = [0] * (MaxW + 1)\n    for i in w:\n        c[i] += 1\n    for i in range(1, MaxW + 1):\n        for j in range(2 * i, MaxW + 1, i):\n            c[i] += c[j]\n    ans = 0\n    for i in range(MaxW, 0, -1):\n        d[i] = c[i] * c[i]\n        for j in range(2 * i, MaxW + 1, i):\n            d[i] -= d[j]\n        ans = (ans + i * d[i]) % mod\n    inv = power(n, mod - 2) % mod\n    print(ans * (n + 1) % mod * (2 * n + 1) % mod * power(6, mod - 2) % mod * inv * inv % mod)\nt = int(input())\nwhile t > 0:\n    n = int(input())\n    str = input().split(' ')\n    w = []\n    for i in str:\n        w.append(int(i))\n    exp_gcd = comp_exp_gcd(w, n)\n    t -= 1", "mod = 998244353\n\ndef power(a, b):\n    if b == 0:\n        return 1\n    if b == 1:\n        return a\n    temp = power(a, int(b / 2)) % mod\n    if b % 2 == 0:\n        return temp % mod * (temp % mod) % mod\n    else:\n        return temp % mod * (a % mod) % mod * (temp % mod) % mod\nMaxW = 500005\n\ndef comp_exp_gcd(w, n):\n    c = [0] * (MaxW + 1)\n    d = [0] * (MaxW + 1)\n    e = [0] * (MaxW + 1)\n    for i in w:\n        c[i] += 1\n    for i in range(1, MaxW + 1):\n        for j in range(2 * i, MaxW + 1, i):\n            c[i] += c[j]\n    ans = 0\n    for i in range(MaxW, 0, -1):\n        d[i] = c[i] * c[i]\n        for j in range(2 * i, MaxW + 1, i):\n            d[i] -= d[j]\n        ans = (ans + i * d[i]) % mod\n    inv = power(n, mod - 2) % mod\n    print(ans * (n + 1) % mod * (2 * n + 1) % mod * power(6, mod - 2) % mod * inv * inv % mod)\nt = int(input())\nwhile t > 0:\n    n = int(input())\n    str = input().split(' ')\n    w = []\n    for i in str:\n        w.append(int(i))\n    exp_gcd = comp_exp_gcd(w, n)\n    t -= 1"]