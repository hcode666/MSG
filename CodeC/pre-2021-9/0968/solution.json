["def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        ans = (1 + a) * S(a * a % m, (n - 1) // 2, m)\n    else:\n        ans = 1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)\n    return ans % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        f = pow(i, e * m + i, m)\n        s += f\n        s = s % m\n    for i in range(2, m + 1):\n        a = pow(i, m, m)\n        d = S(a, e - 1, m)\n        b = pow(i, i, m)\n        s += d % m * b % m\n        s = s % m\n    s += e\n    print(s % m)", "def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        ans = (1 + a) * S(a * a % m, (n - 1) // 2, m)\n    else:\n        ans = 1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)\n    return ans % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        f = pow(i, e * m + i, m)\n        s += f\n        s = s % m\n    for i in range(2, m + 1):\n        a = pow(i, m, m)\n        d = S(a, e - 1, m)\n        b = pow(i, i, m)\n        s += d % m * b % m\n        s = s % m\n    s += e\n    print(s % m)", "def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        ans = (1 + a) * S(a * a % m, (n - 1) // 2, m)\n    else:\n        ans = 1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)\n    return ans % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        f = pow(i, e * m + i, m)\n        s += f\n        s = s % m\n    for i in range(2, m + 1):\n        a = pow(i, m, m)\n        d = S(a, e - 1, m)\n        b = pow(i, i, m)\n        s += d % m * b % m\n        s = s % m\n    s += e\n    print(s % m)", "def p(b, e):\n    t = 1\n    while e:\n        if e & 1:\n            t = t * b % mod\n        b = b * b % mod\n        e >>= 1\n    return t\n\ndef f(i, e):\n    b = p(i, i)\n    t = 0\n    m = 1\n    m2 = p(i, mod)\n    while e:\n        if e & 1:\n            t = (t + m * b % mod) % mod\n            m = m * m2 % mod\n        b = b * (m2 + 1) % mod\n        m2 = m2 * m2 % mod\n        e >>= 1\n    return t\nfor _ in range(int(input())):\n    (n, mod) = map(int, input().split())\n    ans = 0\n    for i in range(1, min(n + 1, mod)):\n        ans = (ans + f(i, (n + mod - i) // mod)) % mod\n    print(ans)", "def p(b, e):\n    t = 1\n    while e:\n        if e & 1:\n            t = t * b % mod\n        b = b * b % mod\n        e >>= 1\n    return t\n\ndef f(i, e):\n    b = p(i, i)\n    t = 0\n    m = 1\n    m2 = p(i, mod)\n    while e:\n        if e & 1:\n            t = (t + m * b % mod) % mod\n            m = m * m2 % mod\n        b = b * (m2 + 1) % mod\n        m2 = m2 * m2 % mod\n        e >>= 1\n    return t\nfor _ in range(int(input())):\n    (n, mod) = map(int, input().split())\n    ans = 0\n    for i in range(1, min(n + 1, mod)):\n        ans = (ans + f(i, (n + mod - i) // mod)) % mod\n    print(ans)", "def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        ans = (1 + a) * S(a * a % m, (n - 1) // 2, m)\n    else:\n        ans = 1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)\n    return ans % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        f = pow(i, e * m + i, m)\n        s += f\n        s = s % m\n    for i in range(2, m + 1):\n        a = pow(i, m, m)\n        d = S(a, e - 1, m)\n        b = pow(i, i, m)\n        s += d % m * b % m\n        s = s % m\n    s += e\n    print(s % m)", "def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        return (1 + a) * S(a * a % m, (n - 1) // 2, m) % m\n    else:\n        return (1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)) % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        s += pow(i, e * m + i, m)\n        s = s % m\n    for i in range(2, m + 1):\n        s += S(pow(i, m, m), e - 1, m) % m * pow(i, i, m) % m\n        s = s % m\n    print((s + e) % m)", "def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        return (1 + a) * S(a * a % m, (n - 1) // 2, m) % m\n    else:\n        return (1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)) % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        s += pow(i, e * m + i, m)\n        s = s % m\n    for i in range(2, m + 1):\n        s += S(pow(i, m, m), e - 1, m) % m * pow(i, i, m) % m\n        s = s % m\n    print((s + e) % m)", "def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        return (1 + a) * S(a * a % m, (n - 1) // 2, m) % m\n    else:\n        return (1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)) % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        s += pow(i, e * m + i, m)\n        s = s % m\n    for i in range(2, m + 1):\n        s += S(pow(i, m, m), e - 1, m) % m * pow(i, i, m) % m\n        s = s % m\n    print((s + e) % m)", "def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        ans = (1 + a) * S(a * a % m, (n - 1) // 2, m)\n    else:\n        ans = 1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)\n    return ans % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        f = pow(i, e * m + i, m)\n        s += f\n        s = s % m\n    for i in range(2, m + 1):\n        a = pow(i, m, m)\n        d = S(a, e - 1, m)\n        b = pow(i, i, m)\n        s += d % m * b % m\n        s = s % m\n    s += e\n    print(s % m)", "def S(a, n, m):\n    if n == -1:\n        return 0\n    if n == 0:\n        return 1\n    if n == 1:\n        return (1 + a) % m\n    if n % 2 == 1:\n        ans = (1 + a) * S(a * a % m, (n - 1) // 2, m)\n    else:\n        ans = 1 + a * (1 + a) * S(a * a % m, n // 2 - 1, m)\n    return ans % m\nfor _ in range(int(input())):\n    (n, m) = map(int, input().split(' '))\n    s = 0\n    e = n // m\n    for i in range(1, n % m + 1):\n        f = pow(i, e * m + i, m)\n        s += f\n        s = s % m\n    for i in range(2, m + 1):\n        a = pow(i, m, m)\n        d = S(a, e - 1, m)\n        b = pow(i, i, m)\n        s += d % m * b % m\n        s = s % m\n    s += e\n    print(s % m)"]