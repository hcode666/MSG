["t = int(input())\nfor i in range(t):\n    (n, m, k) = map(int, input().split())\n    a = list(map(int, input().split()))\n    b = []\n    for j in range(n):\n        e = list(map(int, input().split()))\n        b.append(e)\n    c = []\n    for z in range(n):\n        e = list(map(int, input().split()))\n        c.append(e)\n    p = [0] * n\n    g = [0] * n\n    s = 0\n    for v in range(n):\n        p[v] = b[v][a[v] - 1]\n        s += p[v]\n        x = 0\n        for u in range(m):\n            e = b[v][u] - c[v][u] - p[v]\n            x = max(x, e)\n        g[v] = x\n    g.sort()\n    g.reverse()\n    print(s + sum(g[:k]))", "t = int(input())\nfor i in range(t):\n    (n, m, k) = map(int, input().split())\n    a = list(map(int, input().split()))\n    b = []\n    for j in range(n):\n        e = list(map(int, input().split()))\n        b.append(e)\n    c = []\n    for z in range(n):\n        e = list(map(int, input().split()))\n        c.append(e)\n    p = [0] * n\n    g = [0] * n\n    s = 0\n    for v in range(n):\n        p[v] = b[v][a[v] - 1]\n        s += p[v]\n        x = 0\n        for u in range(m):\n            e = b[v][u] - c[v][u] - p[v]\n            x = max(x, e)\n        g[v] = x\n    g.sort()\n    g.reverse()\n    print(s + sum(g[:k]))", "t = int(input())\nfor i in range(t):\n    (n, m, k) = map(int, input().split())\n    a = list(map(int, input().split()))\n    b = []\n    for j in range(n):\n        e = list(map(int, input().split()))\n        b.append(e)\n    c = []\n    for z in range(n):\n        e = list(map(int, input().split()))\n        c.append(e)\n    p = [0] * n\n    g = [0] * n\n    s = 0\n    for v in range(n):\n        p[v] = b[v][a[v] - 1]\n        s += p[v]\n        x = 0\n        for u in range(m):\n            e = b[v][u] - c[v][u] - p[v]\n            x = max(x, e)\n        g[v] = x\n    g.sort()\n    g.reverse()\n    print(s + sum(g[:k]))", "t = int(input())\nfor i in range(t):\n    (n, m, k) = map(int, input().split())\n    a = list(map(int, input().split()))\n    b = []\n    for j in range(n):\n        e = list(map(int, input().split()))\n        b.append(e)\n    c = []\n    for z in range(n):\n        e = list(map(int, input().split()))\n        c.append(e)\n    p = [0] * n\n    g = [0] * n\n    s = 0\n    for v in range(n):\n        p[v] = b[v][a[v] - 1]\n        s += p[v]\n        x = 0\n        for u in range(m):\n            e = b[v][u] - c[v][u] - p[v]\n            x = max(x, e)\n        g[v] = x\n    g.sort()\n    g.reverse()\n    print(s + sum(g[:k]))", "t = int(input())\nfor i in range(t):\n    (n, m, k) = map(int, input().split())\n    a = list(map(int, input().split()))\n    b = []\n    for j in range(n):\n        e = list(map(int, input().split()))\n        b.append(e)\n    c = []\n    for z in range(n):\n        e = list(map(int, input().split()))\n        c.append(e)\n    p = [0] * n\n    g = [0] * n\n    s = 0\n    for v in range(n):\n        p[v] = b[v][a[v] - 1]\n        s += p[v]\n        x = 0\n        for u in range(m):\n            e = b[v][u] - c[v][u] - p[v]\n            x = max(x, e)\n        g[v] = x\n    g.sort()\n    g.reverse()\n    print(s + sum(g[:k]))", "t = int(input())\nfor i in range(t):\n    (n, m, k) = input().split()\n    n = int(n)\n    m = int(m)\n    k = int(k)\n    a = list(map(int, input().split()))\n    b = list()\n    for j in range(n):\n        temp = list(map(int, input().split()))\n        b.append(temp)\n    c = list()\n    for j in range(n):\n        temp = list(map(int, input().split()))\n        c.append(temp)\n    cost = [0] * n\n    max_gain = [0] * n\n    sum1 = 0\n    for j in range(n):\n        cost[j] = b[j][a[j] - 1]\n        sum1 = sum1 + cost[j]\n        mp = 0\n        for z in range(m):\n            temp = b[j][z] - c[j][z] - cost[j]\n            mp = max(mp, temp)\n        max_gain[j] = mp\n    max_gain.sort()\n    max_gain.reverse()\n    print(sum1 + sum(max_gain[:k]))", "t = int(input())\nfor i in range(t):\n    (n, m, k) = input().split()\n    n = int(n)\n    m = int(m)\n    k = int(k)\n    a = list(map(int, input().split()))\n    b = list()\n    for j in range(n):\n        temp = list(map(int, input().split()))\n        b.append(temp)\n    c = list()\n    for j in range(n):\n        temp = list(map(int, input().split()))\n        c.append(temp)\n    cost = [0] * n\n    max_gain = [0] * n\n    sum1 = 0\n    for j in range(n):\n        cost[j] = b[j][a[j] - 1]\n        sum1 = sum1 + cost[j]\n        mp = 0\n        for z in range(m):\n            temp = b[j][z] - c[j][z] - cost[j]\n            mp = max(mp, temp)\n        max_gain[j] = mp\n    max_gain.sort()\n    max_gain.reverse()\n    print(sum1 + sum(max_gain[:k]))", "t = int(input())\nfor i in range(t):\n    (n, m, k) = input().split()\n    n = int(n)\n    m = int(m)\n    k = int(k)\n    a = list(map(int, input().split()))\n    b = list()\n    for j in range(n):\n        temp = list(map(int, input().split()))\n        b.append(temp)\n    c = list()\n    for j in range(n):\n        temp = list(map(int, input().split()))\n        c.append(temp)\n    cost = [0] * n\n    max_gain = [0] * n\n    sum1 = 0\n    for j in range(n):\n        cost[j] = b[j][a[j] - 1]\n        sum1 = sum1 + cost[j]\n        mp = 0\n        for z in range(m):\n            temp = b[j][z] - c[j][z] - cost[j]\n            mp = max(mp, temp)\n        max_gain[j] = mp\n    max_gain.sort()\n    max_gain.reverse()\n    print(sum1 + sum(max_gain[:k]))"]