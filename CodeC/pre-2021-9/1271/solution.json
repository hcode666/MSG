["mod = 10 ** 9 + 7\n\ndef find(n):\n    if parent[n] < 0:\n        return n\n    else:\n        pt = find(parent[n])\n        xor[n] ^= xor[parent[n]]\n        parent[n] = pt\n        return pt\nfor _ in range(int(input())):\n    (n, q) = map(int, input().split())\n    for i in range(n - 1):\n        input()\n    parent = [-1] * n\n    xor = [0] * n\n    f = n - 1\n    for qq in range(q):\n        (i, j, w) = map(int, input().split())\n        if f == -1:\n            continue\n        i -= 1\n        j -= 1\n        fi = find(i)\n        fj = find(j)\n        if fi == fj:\n            if xor[i] ^ xor[j] ^ w:\n                f = -1\n        else:\n            f -= 1\n            if parent[fi] == parent[fj]:\n                parent[fi] -= 1\n            if parent[fi] > parent[fj]:\n                parent[fi] = fj\n                xor[fi] = xor[i] ^ xor[j] ^ w\n            else:\n                parent[fj] = fi\n                xor[fj] = xor[i] ^ xor[j] ^ w\n    print(pow(2, f, mod)) if f >= 0 else print(0)", "mod = 10 ** 9 + 7\n\ndef find(n):\n    if parent[n] < 0:\n        return n\n    else:\n        pt = find(parent[n])\n        xor[n] ^= xor[parent[n]]\n        parent[n] = pt\n        return pt\nfor _ in range(int(input())):\n    (n, q) = map(int, input().split())\n    for i in range(n - 1):\n        input()\n    parent = [-1] * n\n    xor = [0] * n\n    f = n - 1\n    for qq in range(q):\n        (i, j, w) = map(int, input().split())\n        if f == -1:\n            continue\n        i -= 1\n        j -= 1\n        fi = find(i)\n        fj = find(j)\n        if fi == fj:\n            if xor[i] ^ xor[j] ^ w:\n                f = -1\n        else:\n            f -= 1\n            if parent[fi] == parent[fj]:\n                parent[fi] -= 1\n            if parent[fi] > parent[fj]:\n                parent[fi] = fj\n                xor[fi] = xor[i] ^ xor[j] ^ w\n            else:\n                parent[fj] = fi\n                xor[fj] = xor[i] ^ xor[j] ^ w\n    print(pow(2, f, mod)) if f >= 0 else print(0)"]