["def main():\n    t = int(input())\n    for i in range(0, t):\n        (n, q) = map(int, input().split())\n        arr = list(map(int, input().split()))\n        sum1 = []\n        sqr = []\n        six = []\n        s1 = 0\n        s2 = 0\n        s3 = 0\n        for j in range(0, len(arr)):\n            s1 += arr[j]\n            s2 += arr[j] ** 2\n            s3 += arr[j] ** 6\n            sum1.append(s1)\n            sqr.append(s2)\n            six.append(s3)\n        for k in range(0, q):\n            (a, b, c, d) = map(int, input().split())\n            a -= 1\n            b -= 1\n            c -= 1\n            d -= 1\n            flagres = 0\n            if a > 0:\n                if c > 0:\n                    cv1 = -sum1[a - 1] - (sum1[d] - sum1[c - 1]) + sum1[b]\n                    cv2 = -sqr[a - 1] - (sqr[d] - sqr[c - 1]) + sqr[b]\n                    cv3 = -six[a - 1] - (six[d] - six[c - 1]) + six[b]\n                elif c == 0:\n                    cv1 = -sum1[a - 1] - sum1[d] + sum1[b]\n                    cv2 = -sqr[a - 1] - sqr[d] + sqr[b]\n                    cv3 = -six[a - 1] - sqr[d] + six[b]\n            elif a == 0:\n                if c > 0:\n                    cv1 = -(sum1[d] - sum1[c - 1]) + sum1[b]\n                    cv2 = -(sqr[d] - sqr[c - 1]) + sqr[b]\n                    cv3 = -(six[d] - six[c - 1]) + six[b]\n                elif c == 0:\n                    cv1 = -sum1[d] + sum1[b]\n                    cv2 = -sum1[d] + sqr[b]\n                    cv3 = -sum1[d] + six[b]\n            if cv1 == 0:\n                if cv2 == 0 and abs(cv3) < 0.01:\n                    flagres = 0\n                else:\n                    flagres = 1\n            elif cv2 % cv1 == 0:\n                quo = cv2 // cv1\n                x = (quo + cv1) // 2\n                y = (quo - cv1) // 2\n                if (quo + cv1) % 2 == 0 and (quo - cv1) % 2 == 0:\n                    if x >= 1 and y >= 1:\n                        if abs(x ** 6 - y ** 6 - cv3) < 0.01:\n                            ta = 0\n                            taa = -1\n                            tb = 0\n                            tbb = -1\n                            for vb in range(a, b + 1):\n                                if arr[vb] > x:\n                                    ta = ta + 1\n                                elif arr[vb] == x:\n                                    taa = taa + 1\n                            for vb1 in range(c, d + 1):\n                                if arr[vb1] > y:\n                                    tb = tb + 1\n                                elif arr[vb1] == y:\n                                    tbb = tbb + 1\n                            if ta == tb:\n                                flagres = 0\n                            elif ta + taa == tb or tb + tbb == ta:\n                                flagres = 0\n                            else:\n                                flagres = 1\n                        else:\n                            flagres = 1\n                    else:\n                        flagres = 1\n                else:\n                    flagres = 1\n            else:\n                flagres = 1\n            if flagres == 0:\n                print('YES')\n            else:\n                print('NO')\nmain()", "def main():\n    t = int(input())\n    for i in range(0, t):\n        (n, q) = map(int, input().split())\n        arr = list(map(int, input().split()))\n        sum1 = []\n        sqr = []\n        six = []\n        s1 = 0\n        s2 = 0\n        s3 = 0\n        for j in range(0, len(arr)):\n            s1 += arr[j]\n            s2 += arr[j] ** 2\n            s3 += arr[j] ** 6\n            sum1.append(s1)\n            sqr.append(s2)\n            six.append(s3)\n        for k in range(0, q):\n            (a, b, c, d) = map(int, input().split())\n            a -= 1\n            b -= 1\n            c -= 1\n            d -= 1\n            flagres = 0\n            if a > 0:\n                if c > 0:\n                    cv1 = -sum1[a - 1] - (sum1[d] - sum1[c - 1]) + sum1[b]\n                    cv2 = -sqr[a - 1] - (sqr[d] - sqr[c - 1]) + sqr[b]\n                    cv3 = -six[a - 1] - (six[d] - six[c - 1]) + six[b]\n                elif c == 0:\n                    cv1 = -sum1[a - 1] - sum1[d] + sum1[b]\n                    cv2 = -sqr[a - 1] - sqr[d] + sqr[b]\n                    cv3 = -six[a - 1] - sqr[d] + six[b]\n            elif a == 0:\n                if c > 0:\n                    cv1 = -(sum1[d] - sum1[c - 1]) + sum1[b]\n                    cv2 = -(sqr[d] - sqr[c - 1]) + sqr[b]\n                    cv3 = -(six[d] - six[c - 1]) + six[b]\n                elif c == 0:\n                    cv1 = -sum1[d] + sum1[b]\n                    cv2 = -sum1[d] + sqr[b]\n                    cv3 = -sum1[d] + six[b]\n            if cv1 == 0:\n                if cv2 == 0 and abs(cv3) < 0.01:\n                    flagres = 0\n                else:\n                    flagres = 1\n            elif cv2 % cv1 == 0:\n                quo = cv2 // cv1\n                x = (quo + cv1) // 2\n                y = (quo - cv1) // 2\n                if (quo + cv1) % 2 == 0 and (quo - cv1) % 2 == 0:\n                    if x >= 1 and y >= 1:\n                        if abs(x ** 6 - y ** 6 - cv3) < 0.01:\n                            ta = 0\n                            taa = -1\n                            tb = 0\n                            tbb = -1\n                            for vb in range(a, b + 1):\n                                if arr[vb] > x:\n                                    ta = ta + 1\n                                elif arr[vb] == x:\n                                    taa = taa + 1\n                            for vb1 in range(c, d + 1):\n                                if arr[vb1] > y:\n                                    tb = tb + 1\n                                elif arr[vb1] == y:\n                                    tbb = tbb + 1\n                            if ta == tb:\n                                flagres = 0\n                            elif ta + taa == tb or tb + tbb == ta:\n                                flagres = 0\n                            else:\n                                flagres = 1\n                        else:\n                            flagres = 1\n                    else:\n                        flagres = 1\n                else:\n                    flagres = 1\n            else:\n                flagres = 1\n            if flagres == 0:\n                print('YES')\n            else:\n                print('NO')\nmain()", "def main():\n    t = int(input())\n    for i in range(t):\n        (n, q) = map(int, input().strip().split())\n        arr = list(map(int, input().strip().split()))\n        sum1 = []\n        sqr = []\n        six = []\n        s1 = 0\n        s2 = 0\n        s3 = 0\n        for j in range(len(arr)):\n            s1 += arr[j]\n            s2 += arr[j] ** 2\n            s3 += arr[j] ** 6\n            sum1.append(s1)\n            sqr.append(s2)\n            six.append(s3)\n        for k in range(q):\n            (a, b, c, d) = map(int, input().strip().split())\n            a -= 1\n            b -= 1\n            c -= 1\n            d -= 1\n            flagres = 0\n            if a > 0 and c > 0:\n                cv1 = sum1[b] - sum1[a - 1] - (sum1[d] - sum1[c - 1])\n                cv2 = sqr[b] - sqr[a - 1] - (sqr[d] - sqr[c - 1])\n                cv3 = six[b] - six[a - 1] - (six[d] - six[c - 1])\n            elif a > 0 and c == 0:\n                cv1 = sum1[b] - sum1[a - 1] - sum1[d]\n                cv2 = sqr[b] - sqr[a - 1] - sqr[d]\n                cv3 = six[b] - six[a - 1] - sqr[d]\n            elif a == 0 and c > 0:\n                cv1 = sum1[b] - (sum1[d] - sum1[c - 1])\n                cv2 = sqr[b] - (sqr[d] - sqr[c - 1])\n                cv3 = six[b] - (six[d] - six[c - 1])\n            else:\n                cv1 = sum1[b] - sum1[d]\n                cv2 = sqr[b] - sum1[d]\n                cv3 = six[b] - sum1[d]\n            if cv1 == 0:\n                if cv2 == 0 and abs(cv3) < 0.01:\n                    flagres = 0\n                else:\n                    flagres = 1\n            elif cv2 % cv1 == 0:\n                quo = cv2 // cv1\n                x = (quo + cv1) // 2\n                y = (quo - cv1) // 2\n                if (quo + cv1) % 2 == 0 and (quo - cv1) % 2 == 0:\n                    if x >= 1 and y >= 1:\n                        if abs(x ** 6 - y ** 6 - cv3) < 0.01:\n                            ta = 0\n                            taa = -1\n                            tb = 0\n                            tbb = -1\n                            for vb in range(a, b + 1):\n                                if arr[vb] > x:\n                                    ta = ta + 1\n                                elif arr[vb] == x:\n                                    taa = taa + 1\n                            for vb1 in range(c, d + 1):\n                                if arr[vb1] > y:\n                                    tb = tb + 1\n                                elif arr[vb1] == y:\n                                    tbb = tbb + 1\n                            if ta == tb:\n                                flagres = 0\n                            elif ta + taa == tb or tb + tbb == ta:\n                                flagres = 0\n                            else:\n                                flagres = 1\n                        else:\n                            flagres = 1\n                    else:\n                        flagres = 1\n                else:\n                    flagres = 1\n            else:\n                flagres = 1\n            if flagres == 0:\n                print('YES')\n            else:\n                print('NO')\nmain()", "def main():\n    t = int(input())\n    for i in range(t):\n        (n, q) = map(int, input().strip().split())\n        arr = list(map(int, input().strip().split()))\n        sum1 = []\n        sqr = []\n        six = []\n        s1 = 0\n        s2 = 0\n        s3 = 0\n        for j in range(len(arr)):\n            s1 += arr[j]\n            s2 += arr[j] ** 2\n            s3 += arr[j] ** 6\n            sum1.append(s1)\n            sqr.append(s2)\n            six.append(s3)\n        for k in range(q):\n            (a, b, c, d) = map(int, input().strip().split())\n            a -= 1\n            b -= 1\n            c -= 1\n            d -= 1\n            if a > 0 and c > 0:\n                cv1 = sum1[b] - sum1[a - 1] - (sum1[d] - sum1[c - 1])\n                cv2 = sqr[b] - sqr[a - 1] - (sqr[d] - sqr[c - 1])\n                cv3 = six[b] - six[a - 1] - (six[d] - six[c - 1])\n            elif a > 0 and c == 0:\n                cv1 = sum1[b] - sum1[a - 1] - sum1[d]\n                cv2 = sqr[b] - sqr[a - 1] - sqr[d]\n                cv3 = six[b] - six[a - 1] - sqr[d]\n            elif a == 0 and c > 0:\n                cv1 = sum1[b] - (sum1[d] - sum1[c - 1])\n                cv2 = sqr[b] - (sqr[d] - sqr[c - 1])\n                cv3 = six[b] - (six[d] - six[c - 1])\n            else:\n                cv1 = sum1[b] - sum1[d]\n                cv2 = sqr[b] - sum1[d]\n                cv3 = six[b] - sum1[d]\n            if cv1 == 0:\n                if cv2 == 0 and abs(cv3) < 0.01:\n                    print('YES')\n                else:\n                    print('NO')\n            elif cv2 % cv1 == 0:\n                quo = cv2 // cv1\n                x = (quo + cv1) // 2\n                y = (quo - cv1) // 2\n                if (quo + cv1) % 2 == 0 and (quo - cv1) % 2 == 0:\n                    if x >= 1 and y >= 1:\n                        if abs(x ** 6 - y ** 6 - cv3) < 0.01:\n                            ta = 0\n                            taa = -1\n                            tb = 0\n                            tbb = -1\n                            for vb in range(a, b + 1):\n                                if arr[vb] > x:\n                                    ta += 1\n                                elif arr[vb] == x:\n                                    taa += 1\n                            for vb1 in range(c, d + 1):\n                                if arr[vb1] > y:\n                                    tb += 1\n                                elif arr[vb1] == y:\n                                    tbb += 1\n                            if ta == tb:\n                                print('YES')\n                            elif ta + taa == tb or tb + tbb == ta:\n                                print('YES')\n                            else:\n                                print('NO')\n                        else:\n                            print('NO')\n                    else:\n                        print('NO')\n                else:\n                    print('NO')\n            else:\n                print('NO')\nmain()", "def main():\n    t = int(input())\n    for i in range(t):\n        (n, q) = map(int, input().strip().split())\n        arr = list(map(int, input().strip().split()))\n        sum1 = []\n        sqr = []\n        six = []\n        s1 = 0\n        s2 = 0\n        s3 = 0\n        for j in range(len(arr)):\n            s1 += arr[j]\n            s2 += arr[j] ** 2\n            s3 += arr[j] ** 6\n            sum1 += [s1]\n            sqr += [s2]\n            six += [s3]\n        for k in range(q):\n            (a, b, c, d) = map(int, input().strip().split())\n            a = a - 1\n            b = b - 1\n            c = c - 1\n            d = d - 1\n            if a > 0 and c > 0:\n                cv1 = sum1[b] - sum1[a - 1] - (sum1[d] - sum1[c - 1])\n                cv2 = sqr[b] - sqr[a - 1] - (sqr[d] - sqr[c - 1])\n                cv3 = six[b] - six[a - 1] - (six[d] - six[c - 1])\n            elif a > 0 and c == 0:\n                cv1 = sum1[b] - sum1[a - 1] - sum1[d]\n                cv2 = sqr[b] - sqr[a - 1] - sqr[d]\n                cv3 = six[b] - six[a - 1] - sqr[d]\n            elif a == 0 and c > 0:\n                cv1 = sum1[b] - (sum1[d] - sum1[c - 1])\n                cv2 = sqr[b] - (sqr[d] - sqr[c - 1])\n                cv3 = six[b] - (six[d] - six[c - 1])\n            else:\n                cv1 = sum1[b] - sum1[d]\n                cv2 = sqr[b] - sum1[d]\n                cv3 = six[b] - sum1[d]\n            if cv1 == 0:\n                if cv2 == 0 and abs(cv3) < 0.01:\n                    print('YES')\n                else:\n                    print('NO')\n            elif cv2 % cv1 == 0:\n                quo = cv2 // cv1\n                x = (quo + cv1) // 2\n                y = (quo - cv1) // 2\n                if (quo + cv1) % 2 == 0 and (quo - cv1) % 2 == 0:\n                    if x >= 1 and y >= 1:\n                        if abs(x ** 6 - y ** 6 - cv3) < 0.01:\n                            ta = 0\n                            taa = -1\n                            tb = 0\n                            tbb = -1\n                            for vb in range(a, b + 1):\n                                if arr[vb] > x:\n                                    ta += 1\n                                elif arr[vb] == x:\n                                    taa += 1\n                            for vb1 in range(c, d + 1):\n                                if arr[vb1] > y:\n                                    tb += 1\n                                elif arr[vb1] == y:\n                                    tbb += 1\n                            if ta == tb:\n                                print('YES')\n                            elif ta + taa == tb or tb + tbb == ta:\n                                print('YES')\n                            else:\n                                print('NO')\n                        else:\n                            print('NO')\n                    else:\n                        print('NO')\n                else:\n                    print('NO')\n            else:\n                print('NO')\nmain()", "import sys\nimport math\n\ndef main():\n    T = int(input())\n    for _ in range(T):\n        (N, Q) = list(map(int, input().strip().split(' ')))\n        A = list(map(int, input().strip().split(' ')))\n        Sum = []\n        sqrt = []\n        square = []\n        temp1 = 0\n        tempq = 0\n        temp2 = 0\n        for i in range(len(A)):\n            L = A[i]\n            temp1 += L\n            temp2 += L ** 2\n            tempq += L ** 6\n            Sum += [temp1]\n            square += [temp2]\n            sqrt += [tempq]\n        for jj in range(Q):\n            (a, b, c, d) = list(map(int, input().strip().split(' ')))\n            a = a - 1\n            b = b - 1\n            c = c - 1\n            d = d - 1\n            if a > 0 and c > 0:\n                T1 = Sum[b] - Sum[a - 1] - (Sum[d] - Sum[c - 1])\n                T2 = square[b] - square[a - 1] - (square[d] - square[c - 1])\n                Tq = sqrt[b] - sqrt[a - 1] - (sqrt[d] - sqrt[c - 1])\n            elif a > 0 and c == 0:\n                T1 = Sum[b] - Sum[a - 1] - Sum[d]\n                T2 = square[b] - square[a - 1] - square[d]\n                Tq = sqrt[b] - sqrt[a - 1] - sqrt[d]\n            elif a == 0 and c > 0:\n                T1 = Sum[b] - (Sum[d] - Sum[c - 1])\n                T2 = square[b] - (square[d] - square[c - 1])\n                Tq = sqrt[b] - (sqrt[d] - sqrt[c - 1])\n            elif a == 0 and c == 0:\n                T1 = Sum[b] - Sum[d]\n                T2 = square[b] - square[d]\n                Tq = sqrt[b] - sqrt[d]\n            if T1 == 0:\n                if T2 == 0 and abs(Tq) < 0.01:\n                    print('YES')\n                else:\n                    print('NO')\n            elif T2 % T1 == 0:\n                TTT = T2 // T1\n                x = (TTT + T1) // 2\n                y = (TTT - T1) // 2\n                if (TTT + T1) % 2 == 0 and (TTT - T1) % 2 == 0:\n                    if x >= 1 and y >= 1:\n                        if abs(x ** 6 - y ** 6 - Tq) < 0.01:\n                            temp1 = 0\n                            temp11 = -1\n                            temp2 = 0\n                            temp22 = -1\n                            for i in range(a, b + 1):\n                                if A[i] > x:\n                                    temp1 += 1\n                                elif A[i] == x:\n                                    temp11 += 1\n                            for i in range(c, d + 1):\n                                if A[i] > y:\n                                    temp2 += 1\n                                elif A[i] == y:\n                                    temp22 += 1\n                            if temp1 == temp2:\n                                print('YES')\n                            elif temp1 + temp11 == temp2 or temp2 + temp22 == temp1:\n                                print('YES')\n                            else:\n                                print('NO')\n                        else:\n                            print('NO')\n                    else:\n                        print('NO')\n                else:\n                    print('NO')\n            else:\n                print('NO')\nmain()"]