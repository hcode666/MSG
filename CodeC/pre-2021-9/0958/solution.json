["t = int(input())\nmod = 1000000007\nf = [1]\nfor i in range(1, 200002):\n    f.append(i * f[i - 1] % mod)\nwhile t > 0:\n    t -= 1\n    (n, k) = list(map(int, input().split()))\n    a = list(map(int, input().split()))\n    b = list(map(int, input().split()))\n    p = []\n    s = []\n    for i in range(n + 1):\n        p.append(i)\n        s.append(1)\n\n    def prnt(x):\n        if p[x] != x:\n            p[x] = prnt(p[x])\n        return p[x]\n    for i in range(1, n + 1):\n        aa = prnt(a[i - 1])\n        bb = prnt(b[i - 1])\n        if aa != bb:\n            p[bb] = aa\n            s[aa] += s[bb]\n    ans1 = 0\n    ans2 = 1\n    for i in range(1, n + 1):\n        if prnt(i) == i and s[i] > 1:\n            ans1 += s[i] - 1\n            ans2 = ans2 * f[s[i]] % mod\n    ans2 = ans2 * f[ans1] % mod\n    if k == 1:\n        print(ans1)\n    if k == 2:\n        print(ans1, ans2)", "t = int(input())\nmod = 1000000007\nf = [1]\nfor i in range(1, 200002):\n    f.append(i * f[i - 1] % mod)\nwhile t > 0:\n    t -= 1\n    (n, k) = list(map(int, input().split()))\n    a = list(map(int, input().split()))\n    b = list(map(int, input().split()))\n    p = []\n    s = []\n    for i in range(n + 1):\n        p.append(i)\n        s.append(1)\n\n    def prnt(x):\n        if p[x] != x:\n            p[x] = prnt(p[x])\n        return p[x]\n    for i in range(1, n + 1):\n        aa = prnt(a[i - 1])\n        bb = prnt(b[i - 1])\n        if aa != bb:\n            p[bb] = aa\n            s[aa] += s[bb]\n    ans1 = 0\n    ans2 = 1\n    for i in range(1, n + 1):\n        if prnt(i) == i and s[i] > 1:\n            ans1 += s[i] - 1\n            ans2 = ans2 * f[s[i]] % mod\n    ans2 = ans2 * f[ans1] % mod\n    if k == 1:\n        print(ans1)\n    if k == 2:\n        print(ans1, ans2)"]