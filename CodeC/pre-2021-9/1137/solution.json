["t = int(input())\nx = 1000000007\ni = 0\nflag = 1\n(count1, count2) = (0, 0)\nval = 1\nwhile t:\n    t -= 1\n    a = input()\n    b = input()\n    n = len(a)\n    if n == 1:\n        print('2')\n    if n >= 2:\n        if a[n - 2] == '2' or b[n - 2] == '2':\n            print('0')\n        else:\n            i = 0\n            while i <= n - 2:\n                if count1 == 0 and count2 == 0:\n                    if a[i] == b[i]:\n                        if a[i] == '2':\n                            if a[i + 1] == '2' and a[i + 2] == '1' and (b[i + 1] == '2') and (b[i + 2] == '1'):\n                                val = 8 * val % x\n                                i = i + 2\n                            else:\n                                print('0')\n                                flag = 0\n                                break\n                        elif a[i] == '1':\n                            val = 2 * val % x\n                    elif a[i] == '1' and b[i] == '2':\n                        count2 += 1\n                        val = 2 * val % x\n                    elif a[i] == '2' and b[i] == '1':\n                        count1 += 1\n                        val = 2 * val % x\n                elif count1 == 0 and count2 == 1:\n                    if a[i] == '1' and b[i] == '1':\n                        print('0')\n                        flag = 0\n                        break\n                    elif b[i] == '2' and a[i] == '2':\n                        count2 += 1\n                        count1 += 1\n                        val = 2 * val % x\n                    else:\n                        count2 += 1\n                elif count1 == 0 and count2 == 2:\n                    if a[i] == '1' and b[i] == '1':\n                        val = 2 * val % x\n                        count2 = 0\n                    elif a[i] == '2' and b[i] == '2':\n                        print('0')\n                        flag = 0\n                        break\n                    else:\n                        count2 = 0\n                        count1 += 1\n                elif count1 == 1 and count2 == 0:\n                    if a[i] == '1' and b[i] == '1':\n                        print('0')\n                        flag = 0\n                        break\n                    elif a[i] == '2' and b[i] == '2':\n                        count2 += 1\n                        count1 += 1\n                        val = 2 * val % x\n                    else:\n                        count1 += 1\n                elif count1 == 1 and count2 == 2:\n                    if a[i] == b[i]:\n                        print('0')\n                        flag = 0\n                        break\n                    else:\n                        count1 += 1\n                        count2 = 0\n                elif count1 == 2 and count2 == 0:\n                    if a[i] == '1' and b[i] == '1':\n                        val = 2 * val % x\n                        count1 = 0\n                    elif a[i] == '2' and b[i] == '2':\n                        print('0')\n                        flag = 0\n                        break\n                    else:\n                        count1 = 0\n                        count2 += 1\n                elif count1 == 2 and count2 == 1:\n                    if a[i] == b[i]:\n                        print('0')\n                        flag = 0\n                        break\n                    else:\n                        count2 += 1\n                        count1 = 0\n                elif count1 == 2 and count2 == 2:\n                    if a[i] == b[i] and a[i] == '1':\n                        val = 2 * val % x\n                        count1 = 0\n                        count2 = 0\n                    else:\n                        print('0')\n                        flag = 0\n                        break\n                i += 1\n            if flag != 0:\n                print(val * 2 % x)\n            val = 1\n            count1 = 0\n            count2 = 0\n            flag = 1", "t = int(input())\nx = 1000000007\ni = 0\nflag = 1\n(count1, count2) = (0, 0)\nval = 1\nwhile t:\n    t -= 1\n    a = input()\n    b = input()\n    n = len(a)\n    if n == 1:\n        print('2')\n    if n >= 2:\n        if a[n - 2] == '2' or b[n - 2] == '2':\n            print('0')\n        else:\n            i = 0\n            while i <= n - 2:\n                if count1 == 0 and count2 == 0:\n                    if a[i] == b[i]:\n                        if a[i] == '2':\n                            if a[i + 1] == '2' and a[i + 2] == '1' and (b[i + 1] == '2') and (b[i + 2] == '1'):\n                                val = 8 * val % x\n                                i = i + 2\n                            else:\n                                print('0')\n                                flag = 0\n                                break\n                        elif a[i] == '1':\n                            val = 2 * val % x\n                    elif a[i] == '1' and b[i] == '2':\n                        count2 += 1\n                        val = 2 * val % x\n                    elif a[i] == '2' and b[i] == '1':\n                        count1 += 1\n                        val = 2 * val % x\n                elif count1 == 0 and count2 == 1:\n                    if a[i] == '1' and b[i] == '1':\n                        print('0')\n                        flag = 0\n                        break\n                    elif b[i] == '2' and a[i] == '2':\n                        count2 += 1\n                        count1 += 1\n                        val = 2 * val % x\n                    else:\n                        count2 += 1\n                elif count1 == 0 and count2 == 2:\n                    if a[i] == '1' and b[i] == '1':\n                        val = 2 * val % x\n                        count2 = 0\n                    elif a[i] == '2' and b[i] == '2':\n                        print('0')\n                        flag = 0\n                        break\n                    else:\n                        count2 = 0\n                        count1 += 1\n                elif count1 == 1 and count2 == 0:\n                    if a[i] == '1' and b[i] == '1':\n                        print('0')\n                        flag = 0\n                        break\n                    elif a[i] == '2' and b[i] == '2':\n                        count2 += 1\n                        count1 += 1\n                        val = 2 * val % x\n                    else:\n                        count1 += 1\n                elif count1 == 1 and count2 == 2:\n                    if a[i] == b[i]:\n                        print('0')\n                        flag = 0\n                        break\n                    else:\n                        count1 += 1\n                        count2 = 0\n                elif count1 == 2 and count2 == 0:\n                    if a[i] == '1' and b[i] == '1':\n                        val = 2 * val % x\n                        count1 = 0\n                    elif a[i] == '2' and b[i] == '2':\n                        print('0')\n                        flag = 0\n                        break\n                    else:\n                        count1 = 0\n                        count2 += 1\n                elif count1 == 2 and count2 == 1:\n                    if a[i] == b[i]:\n                        print('0')\n                        flag = 0\n                        break\n                    else:\n                        count2 += 1\n                        count1 = 0\n                elif count1 == 2 and count2 == 2:\n                    if a[i] == b[i] and a[i] == '1':\n                        val = 2 * val % x\n                        count1 = 0\n                        count2 = 0\n                    else:\n                        print('0')\n                        flag = 0\n                        break\n                i += 1\n            if flag != 0:\n                print(val * 2 % x)\n            val = 1\n            count1 = 0\n            count2 = 0\n            flag = 1", "def fun(a):\n    n = len(a)\n    i = 0\n    b = []\n    while i < n:\n        c = 0\n        while i < n - 1 and a[i] == a[i + 1]:\n            c += 1\n            i += 1\n        b.append([a[i], c + 1])\n        i += 1\n    return b\n\ndef tatti(h):\n    n = len(h)\n    i = 0\n    b = []\n    while i < n:\n        c = 0\n        while i < n - 1 and h[i][0] == h[i + 1][0]:\n            c += 1\n            i += 1\n        b.append([h[i][0], h[i][1], c + 1])\n        i += 1\n    return b\n\ndef mod(a, b, m):\n    x = 1\n    y = a\n    while b > 0:\n        if b % 2:\n            x = x * y % m\n        y = y * y % m\n        b //= 2\n    return x % m\n\ndef rem(s):\n    s = list(s)\n    l = len(s)\n    i = l - 1\n    ans = []\n    c = 0\n    while i >= 0:\n        if s[i] == 1 and s[i - 1] == 2 and (s[i - 2] == 1) and (i >= 2):\n            i -= 3\n            c += 1\n        else:\n            i -= 1\n            ans.append(c)\n            c = 0\n    ans.append(c)\n    count = 0\n    flag = 0\n    for i in range(len(ans)):\n        if ans[i] != 0:\n            count += 1\n        flag = max(flag, ans[i])\n    return (count, flag)\nfor _ in range(int(input())):\n    md = 10 ** 9 + 7\n    s1 = input()\n    s2 = input()\n    x = []\n    l = len(s1)\n    for i in range(l):\n        if s1[i] == '2' and s2[i] == '2':\n            x.append(2)\n        elif s1[i] == '1' and s2[i] == '1':\n            x.append(0)\n        else:\n            x.append(1)\n    if l == 1:\n        ans = 2\n    elif l == 2:\n        if s1[0] == '2' or s2[0] == '2':\n            ans = 0\n        else:\n            ans = 4\n    else:\n        x.pop()\n        x.pop()\n        h = fun(x)\n        for i in range(1, len(h) - 1):\n            if h[i][0] == 2 and h[i][1] == 1:\n                if h[i - 1][0] == 1 and h[i + 1][0] == 1:\n                    h[i - 1][1] -= 1\n                    h[i + 1][1] -= 1\n                    h[i][0] = -1\n        hn = []\n        for i in range(len(h)):\n            if h[i][1] != 0:\n                hn.append(h[i])\n        hnn = tatti(hn)\n        flag = 0\n        ans = 1\n        for i in range(len(hnn)):\n            if hnn[i][0] == 0:\n                ans = ans * mod(2, hnn[i][1], md) % md\n            elif hnn[i][0] == 1:\n                if hnn[i][1] % 2 == 0:\n                    ans *= 2\n                    ans = ans % md\n                else:\n                    ans *= 0\n            elif hnn[i][0] == 2:\n                if hnn[i][1] == 2:\n                    if i - 1 >= 0 and hnn[i - 1][0] != 0 or (i + 1 < len(hnn) and hnn[i + 1][0] != 0):\n                        ans *= 0\n                    else:\n                        ans *= 4\n                        ans = ans % md\n                else:\n                    ans *= 0\n            elif (i - 1 >= 0 and hnn[i - 1][0] == 1) and (i + 1 <= len(hnn) - 1 and hnn[i + 1][0] == 1):\n                if hnn[i][2] - 1 >= 0:\n                    ans = ans * mod(2, hnn[i][2] - 1, md)\n                    ans = ans % md\n            elif i - 1 >= 0 and hnn[i - 1][0] == 1 or (i + 1 <= len(hnn) - 1 and hnn[i + 1][0] == 1):\n                ans = ans * mod(2, hnn[i][2], md)\n                ans = ans % md\n            else:\n                ans = ans * mod(2, hnn[i][2] + 1, md)\n                ans = ans % md\n        if s1[l - 2] == '2' or s2[l - 2] == '2':\n            ans *= 0\n        else:\n            ans *= 4\n            ans = ans % md\n    print(ans % md)", "size = 100000\nmodval = 1000000007\n\ndef main():\n    t = int(input())\n    for _ in range(t):\n        a = input()\n        b = input()\n        l = len(a)\n        count = 0\n        if l == 1:\n            count = 2\n        elif l < 4:\n            if checkGood(a, b, l) == 1:\n                if l == 2:\n                    count = 4\n                else:\n                    count = 8\n        elif a[l - 2] == '2' or b[l - 2] == '2':\n            count = 0\n        elif parityCheck(a, b, l) == 0 and columnCheck(a, b, l) == 1:\n            i = 0\n            check = 1\n            count = 1\n            while i < l - 2:\n                while i < l - 2 and a[i] == '1' and (b[i] == '1'):\n                    i += 1\n                check = 1\n                if a[i] != b[i]:\n                    if i < 2 or countTwo(a, b, i - 1) == 0:\n                        count *= 2\n                        if count >= modval:\n                            count = count % modval\n                    t1 = countTwo(a, b, i + 1)\n                    t2 = countTwo(a, b, i + 2)\n                    if t1 == 0:\n                        check = 0\n                    elif t1 == 1:\n                        i += 2\n                    elif t2 == 1:\n                        i += 3\n                    else:\n                        check = 0\n                elif i < l - 2 and a[i] == '2' and (b[i] == '2'):\n                    if i < l - 3 and countTwo(a, b, i + 1) == 2 and (countTwo(a, b, i + 2) == 0):\n                        i += 3\n                    else:\n                        check = 0\n                if check == 0:\n                    count = 0\n                    break\n            if check == 1:\n                count *= 2\n                if count >= modval:\n                    count = count % modval\n                for i in range(l - 1):\n                    if a[i] == b[i]:\n                        count *= 2\n                        if count >= modval:\n                            count = count % modval\n        print(count)\n\ndef checkGood(a, b, l):\n    for i in range(l - 1):\n        if a[i] == '2' or b[i] == '2':\n            return 0\n    return 1\n\ndef parityCheck(a, b, l):\n    count = 0\n    for i in range(l - 2):\n        if a[i] != b[i]:\n            count += 1\n    return count % 2\n\ndef columnCheck(a, b, l):\n    if countTwo(a, b, 0) > countTwo(a, b, 1):\n        return 0\n    for i in range(l - 2):\n        if countTwo(a, b, i) > countTwo(a, b, i - 1) + countTwo(a, b, i + 1):\n            return 0\n    return 1\n\ndef countTwo(a, b, i):\n    count = 0\n    if a[i] == '2':\n        count += 1\n    if b[i] == '2':\n        count += 1\n    return count\nmain()", "MOD = 1000000007\nfor i in range(int(input())):\n    a = input()\n    b = input()\n    n = len(a)\n    if n == 1:\n        print(2)\n    elif a[n - 2] == '2' or b[n - 2] == '2':\n        print(0)\n    else:\n        (fr, sc) = (0, 0)\n        ans = 1\n        for j in range(n - 1):\n            c = int(a[j]) + int(b[j])\n            if c == 2:\n                if fr % 2 == 0 and sc % 2 == 0:\n                    ans = ans * 2 % MOD\n                    (fr, sc) = (0, 0)\n                else:\n                    ans = 0\n            elif c == 3:\n                if fr == 0 and sc == 0:\n                    fr = 1\n                    ans = ans * 2 % MOD\n                elif fr == 1 and sc == 0:\n                    fr = 2\n                elif fr == 2 and sc == 0:\n                    sc = 1\n                    fr = 0\n                elif fr == 0 and sc == 1:\n                    sc = 2\n                elif fr == 0 and sc == 2:\n                    fr = 1\n                    sc = 0\n                elif fr == 1 and sc == 1:\n                    ans = 0\n                elif fr == 2 and sc == 1:\n                    fr = 0\n                    sc = 2\n                elif fr == 1 and sc == 2:\n                    fr = 2\n                    sc = 0\n                elif fr == 2 and sc == 2:\n                    ans = 0\n            elif c == 4:\n                if fr == 0 and sc == 0:\n                    fr = 1\n                    sc = 1\n                    ans = ans * 2 % MOD\n                elif fr == 1 and sc == 0:\n                    fr = 2\n                    sc = 1\n                    ans = ans * 2 % MOD\n                elif fr == 2 and sc == 0:\n                    ans = 0\n                elif fr == 0 and sc == 1:\n                    sc = 2\n                    fr = 1\n                    ans = ans * 2 % MOD\n                elif fr == 0 and sc == 2:\n                    ans = 0\n                elif fr == 1 and sc == 1:\n                    fr = 2\n                    sc = 2\n                    ans = ans * 2 % MOD\n                elif fr == 2 and sc == 1:\n                    ans = 0\n                elif fr == 1 and sc == 2:\n                    ans = 0\n                elif fr == 2 and sc == 2:\n                    ans = 0\n            if ans == 0:\n                break\n        ans = ans * 2 % MOD\n        print(ans)", "T = int(input())\nfor t in range(T):\n    S1 = list(input())\n    S2 = list(input())\n    N = len(S1)\n    MOD = 1000000007\n    count = 1\n    for n in range(N - 1):\n        if S2[n] == '2':\n            (S1[n], S2[n]) = (S2[n], S1[n])\n        if S1[n] == S2[n]:\n            count = count * 2 % MOD\n    count = count * 2 % MOD\n    l22 = list('22')\n    l11 = list('11')\n    l221 = list('221')\n    l222 = list('222')\n    l121 = list('121')\n    n = 0\n    expected = [1, 2, 3, 4]\n    got = 0\n    while n < N - 2:\n        inc = 1\n        if 1 in expected and S1[n:n + 2] == l22 and (S2[n:n + 2] == l11):\n            expected = [1, 2, 4]\n            inc = 2\n        elif 2 in expected and S1[n] == '1' and (S2[n] == '1'):\n            if len(expected) < 4:\n                count = count * 2 % MOD\n            expected = [1, 2, 3, 4]\n            inc = 1\n        elif 3 in expected and S1[n:n + 3] == l221 and (S2[n:n + 3] == l221):\n            expected = [1, 2, 3, 4]\n            inc = 3\n        elif 4 in expected and S1[n:n + 3] == l222 and (S2[n:n + 3] == l121):\n            expected = [1, 2, 4]\n            inc = 3\n        else:\n            count = 0\n            break\n        n += inc\n    if N > 1 and (not (S1[N - 2] == '1' and S2[N - 2] == '1')):\n        count = 0\n    elif len(expected) < 4:\n        count = count * 2 % MOD\n    print(count)", "import sys\nimport numpy as np\ntrans = {(11, 2): 11, (11, 3): 12, (11, 4): 22, (12, 2): None, (12, 3): 13, (12, 4): 23, (13, 2): 11, (13, 3): 12, (13, 4): None, (22, 2): None, (22, 3): None, (22, 4): 33, (23, 2): None, (23, 3): 13, (23, 4): None, (33, 2): 11, (33, 3): None, (33, 4): None}\n\ndef mpow(x, k, m):\n    ret = 1\n    x\n    while k > 0:\n        if k % 2 == 1:\n            ret = ret * x % m\n        x = x * x % m\n        k = k // 2\n    return ret\n\ndef solve(a, b):\n    n = len(a)\n    if n == 1:\n        return 2\n    if a[-2] == 2 or b[-2] == 2:\n        return 0\n    a[-1] = 1\n    b[-1] = 1\n    c = np.array(a) + np.array(b)\n    ret = 0\n    state = 11\n    for x in c:\n        if x == 2 or x == 4:\n            ret += 1\n        if state == 11 and x == 3:\n            ret += 1\n        state = trans[state, x]\n        if state is None:\n            return 0\n    return mpow(2, ret, 10 ** 9 + 7)\nf = sys.stdin\nt = int(f.readline())\nfor i in range(t):\n    a = list(map(int, list(f.readline())[:-1]))\n    b = list(map(int, list(f.readline())[:-1]))\n    print(solve(a, b))", "modulo = 1000000007\n\ndef pow(a, n):\n    res = 1\n    while n > 0:\n        if n & 1:\n            res *= a\n            res %= modulo\n        a *= a\n        a %= modulo\n        n //= 2\n    return res\n\ndef test2(s):\n    if '4' in s:\n        return True\n    if len(s) & 1 > 0:\n        return True\n    return False\n\ndef test(s):\n    sss = s.split('343')\n    return any(map(test2, sss))\nT = int(input())\nfor t in range(T):\n    s1 = input()\n    s2 = input()\n    ss = ''.join(map(lambda x, y: str(int(x) + int(y)), s1, s2))\n    if len(ss) > 0:\n        ss = ss[:-1] + '2'\n    if '444' in ss or '344' in ss or '443' in ss or (len(ss) > 1 and ss[-2] != '2'):\n        print(0)\n    else:\n        twos = list(filter(lambda x: x and x != '44', ss.split('2')))\n        if any(map(test, twos)):\n            print(0)\n        else:\n            ones = sum(map(lambda x: x != '3', ss))\n            print(pow(2, ones + len(twos)))"]