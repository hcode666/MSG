["seive = [1] * (10 ** 6 + 1)\nprev = [1] * (10 ** 6 + 1)\nfor i in range(2, len(seive)):\n    if seive[i] > 1:\n        continue\n    t = 1\n    for j in range(i, len(seive), i):\n        seive[j] = i\n        prev[j] = t\n        t += 1\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = [int(c) for c in input().split()]\n    v = [0] * (10 ** 6 + 1)\n    ans = -1\n    l = 0\n    for r in range(len(arr)):\n        j = arr[r]\n        z = -1\n        while j > 1:\n            d = seive[j]\n            if d != z:\n                l = max(l, v[d])\n                v[d] = r + 1\n            j = prev[j]\n            z = d\n        if l < r:\n            ans = max(ans, r - l + 1)\n    print(ans)", "seive = [1] * (10 ** 6 + 1)\nprev = [1] * (10 ** 6 + 1)\nfor i in range(2, len(seive)):\n    if seive[i] > 1:\n        continue\n    t = 1\n    for j in range(i, len(seive), i):\n        seive[j] = i\n        prev[j] = t\n        t += 1\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = [int(c) for c in input().split()]\n    v = [0] * (10 ** 6 + 1)\n    ans = -1\n    l = 0\n    for r in range(len(arr)):\n        j = arr[r]\n        z = -1\n        while j > 1:\n            d = seive[j]\n            if d != z:\n                l = max(l, v[d])\n                v[d] = r + 1\n            j = prev[j]\n            z = d\n        if l < r:\n            ans = max(ans, r - l + 1)\n    print(ans)", "import sys\ninput = sys.stdin.readline\nimport math\nn = 10 ** 6\ndp = [0] * (n + 1)\nfor i in range(2, 1001):\n    if dp[i] == 0:\n        dp[i] = i\n        j = i * i\n        while j <= n:\n            dp[j] = i\n            j = j + i\nfor i in range(n + 1):\n    if dp[i] == 0:\n        dp[i] = i\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    arr = [int(x) for x in input().split()]\n    prev = 0\n    d = {}\n    ans = -1\n    for i in range(n):\n        ele = arr[i]\n        while ele != 1:\n            x = dp[ele]\n            if x in d:\n                prev = max(prev, d[x] + 1)\n            d[x] = i\n            while ele % x == 0:\n                ele = ele // x\n        if i - prev != 0:\n            ans = max(ans, i - prev + 1)\n    print(ans)", "from sys import stdin\ninput = stdin.readline\nsize = 10 ** 6 + 1\nprimef = [[] for i in range(size)]\nprime = []\nfor i in range(2, size):\n    if len(primef[i]) == 0:\n        for j in range(i, size, i):\n            primef[j].append(i)\n        prime.append(i)\n\ndef nextpossible(j, length, x):\n    while their[ind[x]]:\n        for i in primef[a[j]]:\n            their[ind[i]] -= 1\n        j += 1\n        length -= 1\n    return [j, length]\n\ndef answer():\n    for i in range(len(prime)):\n        ind[prime[i]] = i\n    (j, ans, length) = (0, -1, 0)\n    for i in range(n):\n        for x in primef[a[i]]:\n            if their[ind[x]]:\n                (j, length) = nextpossible(j, length, x)\n            their[ind[x]] += 1\n        length += 1\n        if length > 1:\n            ans = max(ans, length)\n    return ans\nfor T in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    ind = dict()\n    their = [0] * len(prime)\n    print(answer())", "from sys import stdin\ninput = stdin.readline\nsize = 10 ** 6 + 1\nprimef = [[] for i in range(size)]\nprime = []\nfor i in range(2, size):\n    if len(primef[i]) == 0:\n        for j in range(i, size, i):\n            primef[j].append(i)\n        prime.append(i)\n\ndef nextpossible(j, length, x):\n    while their[ind[x]]:\n        for i in primef[a[j]]:\n            their[ind[i]] -= 1\n        j += 1\n        length -= 1\n    return [j, length]\n\ndef answer():\n    for i in range(len(prime)):\n        ind[prime[i]] = i\n    (j, ans, length) = (0, -1, 0)\n    for i in range(n):\n        for x in primef[a[i]]:\n            if their[ind[x]]:\n                (j, length) = nextpossible(j, length, x)\n            their[ind[x]] += 1\n        length += 1\n        if length > 1:\n            ans = max(ans, length)\n    return ans\nfor T in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    ind = dict()\n    their = [0] * len(prime)\n    print(answer())", "import sys\ninput = sys.stdin.readline\nimport math\nn = 10 ** 6\ndp = [0] * (n + 1)\nfor i in range(2, 1001):\n    if dp[i] == 0:\n        dp[i] = i\n        j = i * i\n        while j <= n:\n            dp[j] = i\n            j = j + i\nfor i in range(n + 1):\n    if dp[i] == 0:\n        dp[i] = i\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    arr = [int(x) for x in input().split()]\n    prev = 0\n    d = {}\n    ans = -1\n    for i in range(n):\n        ele = arr[i]\n        while ele != 1:\n            x = dp[ele]\n            if x in d:\n                prev = max(prev, d[x] + 1)\n            d[x] = i\n            while ele % x == 0:\n                ele = ele // x\n        if i - prev != 0:\n            ans = max(ans, i - prev + 1)\n    print(ans)", "import sys\ninput = sys.stdin.readline\nimport math\nn = 10 ** 6\ndp = [0] * (n + 1)\nfor i in range(2, 1001):\n    if dp[i] == 0:\n        dp[i] = i\n        j = i * i\n        while j <= n:\n            dp[j] = i\n            j = j + i\nfor i in range(n + 1):\n    if dp[i] == 0:\n        dp[i] = i\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    arr = [int(x) for x in input().split()]\n    prev = 0\n    d = {}\n    ans = -1\n    for i in range(n):\n        ele = arr[i]\n        while ele != 1:\n            x = dp[ele]\n            if x in d:\n                prev = max(prev, d[x] + 1)\n            d[x] = i\n            while ele % x == 0:\n                ele = ele // x\n        if i - prev != 0:\n            ans = max(ans, i - prev + 1)\n    print(ans)", "seive = [1] * (10 ** 6 + 1)\nprev = [1] * (10 ** 6 + 1)\nfor i in range(2, len(seive)):\n    if seive[i] > 1:\n        continue\n    t = 1\n    for j in range(i, len(seive), i):\n        seive[j] = i\n        prev[j] = t\n        t += 1\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = [int(c) for c in input().split()]\n    v = [0] * (10 ** 6 + 1)\n    ans = -1\n    l = 0\n    for r in range(len(arr)):\n        j = arr[r]\n        z = -1\n        while j > 1:\n            d = seive[j]\n            if d != z:\n                l = max(l, v[d])\n                v[d] = r + 1\n            j = prev[j]\n            z = d\n        if l < r:\n            ans = max(ans, r - l + 1)\n    print(ans)", "seive = [1] * (10 ** 6 + 1)\nprev = [1] * (10 ** 6 + 1)\nfor i in range(2, len(seive)):\n    if seive[i] > 1:\n        continue\n    t = 1\n    for j in range(i, len(seive), i):\n        seive[j] = i\n        prev[j] = t\n        t += 1\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = [int(c) for c in input().split()]\n    v = [0] * (10 ** 6 + 1)\n    ans = -1\n    l = 0\n    for r in range(len(arr)):\n        j = arr[r]\n        z = -1\n        while j > 1:\n            d = seive[j]\n            if d != z:\n                l = max(l, v[d])\n                v[d] = r + 1\n            j = prev[j]\n            z = d\n        if l < r:\n            ans = max(ans, r - l + 1)\n    print(ans)", "seive = [1] * (10 ** 6 + 1)\nprev = [1] * (10 ** 6 + 1)\nfor i in range(2, len(seive)):\n    if seive[i] > 1:\n        continue\n    t = 1\n    for j in range(i, len(seive), i):\n        seive[j] = i\n        prev[j] = t\n        t += 1\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = [int(c) for c in input().split()]\n    v = [0] * (10 ** 6 + 1)\n    ans = -1\n    l = 0\n    for r in range(len(arr)):\n        j = arr[r]\n        z = -1\n        while j > 1:\n            d = seive[j]\n            if d != z:\n                l = max(l, v[d])\n                v[d] = r + 1\n            j = prev[j]\n            z = d\n        if l < r:\n            ans = max(ans, r - l + 1)\n    print(ans)", "sieve = [1] * (10 ** 6 + 1)\nprev = sieve.copy()\nfor i in range(2, len(sieve)):\n    if sieve[i] > 1:\n        continue\n    t = 1\n    for j in range(i, len(sieve), i):\n        sieve[j] = i\n        prev[j] = t\n        t += 1\nfor test in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    ans = -1\n    v = [0] * (10 ** 6 + 1)\n    l = 0\n    for r in range(n):\n        j = a[r]\n        z = -1\n        while j > 1:\n            d = sieve[j]\n            if d != z:\n                l = max(l, v[d])\n                v[d] = r + 1\n            j = prev[j]\n            z = d\n        if l < r:\n            ans = max(ans, r - l + 1)\n    print(ans)", "p = 10 ** 6 + 5\n\ndef sieve():\n    l = [1] * p\n    i = 2\n    l[0] = l[1] = 0\n    spf = [i for i in range(p)]\n    while i * i <= p:\n        if l[i]:\n            for j in range(2 * i, p, i):\n                l[j] = 0\n                if spf[j] == j:\n                    spf[j] = i\n        i += 1\n    return (spf, [i for i in range(p) if l[i]])\n(spf, prms) = sieve()\n\ndef get(x):\n    s = set()\n    while x > 1:\n        s.add(spf[x])\n        x = x // spf[x]\n    return s\nfor _ in range(int(input())):\n    n = int(input())\n    prev = {}\n    for x in prms:\n        prev[x] = -1\n    l = [int(i) for i in input().split()]\n    maxi = 0\n    curr = -1\n    for i in range(n):\n        g = get(l[i])\n        for pf in g:\n            curr = max(curr, prev[pf])\n        if curr == -1:\n            maxi = max(maxi, i - curr)\n        else:\n            maxi = max(maxi, i - curr)\n        for pf in g:\n            prev[pf] = i\n    print(maxi if maxi > 1 else -1)", "import sys\nmaxd = pow(10, 6) + 1\nfactors = [[] for i in range(maxd)]\nfor i in range(2, maxd):\n    if len(factors[i]) == 0:\n        for j in range(i, maxd, i):\n            factors[j].append(i)\nt = int(sys.stdin.readline())\nfor _ in range(t):\n    n = int(sys.stdin.readline())\n    arr = list(map(int, sys.stdin.readline().split()))\n    last = [-1] * maxd\n    start = [-1] * maxd\n    ans = -1\n    for i in range(n):\n        val = arr[i]\n        x = -1\n        for fact in factors[val]:\n            if last[fact] != -1:\n                x = max(x, last[fact])\n            last[fact] = i\n        if i > 0:\n            start[i] = max(start[i - 1], x)\n            ans = max(ans, i - start[i])\n    print(ans if ans > 1 else -1)", "maxlimt = int(1000000.0 + 5)\nfactors = [list() for i in range(maxlimt)]\n\ndef sieve():\n    (factors[0], factors[1]) = (list(), list())\n    for i in range(2, maxlimt):\n        if len(factors[i]) == 0:\n            for j in range(i, maxlimt, i):\n                factors[j].append(i)\nsieve()\nt = int(input())\nwhile t:\n    n = int(input().strip())\n    arr = [int(x) for x in input().strip().split()]\n    indices = [-1] * maxlimt\n    (left, ans) = (0, 0)\n    for right in range(n):\n        val = arr[right]\n        for x in factors[val]:\n            left = max(left, indices[x] + 1)\n            indices[x] = right\n        dis = right - left + 1\n        ans = max(ans, dis)\n    if ans < 2:\n        print(-1)\n    else:\n        print(ans)\n    t -= 1", "temp = [1 for i in range(10 ** 6 + 1)]\nfor i in range(2, 10 ** 6 + 1):\n    for j in range(i, 10 ** 6 + 1, i):\n        if temp[j] == 1:\n            temp[j] = i\n\ndef getFactor(num):\n    last = None\n    factors = []\n    while num > 1:\n        if temp[num] != last:\n            factors.append(temp[num])\n        last = temp[num]\n        num //= last\n    return factors\n\ndef find():\n    n = int(input())\n    a = list(map(int, input().split()))\n    dic = {}\n    big = 0\n    index = -1\n    for i in range(n):\n        factors = getFactor(a[i])\n        for f in factors:\n            if f in dic:\n                index = max(index, dic[f])\n            dic[f] = i\n        big = max(big, i - index)\n    if big == 1:\n        print(-1)\n    else:\n        print(big)\nt = int(input())\nfor i in range(t):\n    find()"]