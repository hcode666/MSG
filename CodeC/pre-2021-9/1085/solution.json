["import math\naa = [0 for i in range(1000 * 1000 + 9)]\nfact = [0 for i in range(1000 * 1000 + 9)]\nindices = []\n\ndef SoE():\n    for i in range(2, 1000 * 1000 + 1):\n        if fact[i] == 0:\n            for j in range(i, 1000 * 1000 + 1, i):\n                if fact[j] == 0:\n                    fact[j] = i\n\ndef primes(n):\n    while n > 1:\n        x = 0\n        pnum = fact[n]\n        while n % pnum == 0:\n            x = 1 - x\n            n //= pnum\n        if x == 1:\n            aa[pnum] += 1\n            indices.append(pnum)\nt = int(input())\nSoE()\nfor i in range(t):\n    n = int(input())\n    b = list(map(int, input().strip().split()))\n    nb2 = n // 2\n    for i in b:\n        primes(i)\n    ans = 0\n    for i in indices:\n        if aa[i] > nb2:\n            ans = ans + n - aa[i]\n        else:\n            ans += aa[i]\n        aa[i] = 0\n    print(ans)\n    indices = []", "import math\naa = [0 for i in range(1000 * 1000 + 9)]\nfact = [0 for i in range(1000 * 1000 + 9)]\nindices = []\n\ndef SoE():\n    for i in range(2, 1000 * 1000 + 1):\n        if fact[i] == 0:\n            for j in range(i, 1000 * 1000 + 1, i):\n                if fact[j] == 0:\n                    fact[j] = i\n\ndef primes(n):\n    while n > 1:\n        x = 0\n        pnum = fact[n]\n        while n % pnum == 0:\n            x = 1 - x\n            n //= pnum\n        if x == 1:\n            aa[pnum] += 1\n            indices.append(pnum)\nt = int(input())\nSoE()\nfor i in range(t):\n    n = int(input())\n    b = list(map(int, input().strip().split()))\n    nb2 = n // 2\n    for i in b:\n        primes(i)\n    ans = 0\n    for i in indices:\n        if aa[i] > nb2:\n            ans = ans + n - aa[i]\n        else:\n            ans += aa[i]\n        aa[i] = 0\n    print(ans)\n    indices = []"]