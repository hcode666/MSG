["m = 1000000000 + 7\nfor i in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    s = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % m\n        ans = (2 * ans + s * a[i]) % m\n        s = (s + p * a[i]) % m\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    p1 = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + p1 * a[i]) % s\n        p1 = (p1 + p * a[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    p1 = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + p1 * a[i]) % s\n        p1 = (p1 + p * a[i]) % s\n    print(ans)", "for i in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    (mul, mod) = ([a[0]], 1000000007)\n    (sumy, temp) = (0, a[0])\n    pr1 = 1\n    for i in range(1, n + 1):\n        pr = a[i] * temp\n        sumy = 2 * sumy + pr\n        temp += a[i] * pr1\n        pr1 = pr1 * 2 % mod\n    print(sumy * 2 % mod)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "for i in range(int(input())):\n    m = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    x = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % m\n        x = (2 * x + t * a[i]) % m\n        t = (t + p * a[i]) % m\n    print(x)", "M = 10 ** 9 + 7\nfor t in range(int(input())):\n    N = int(input())\n    L = [int(i) for i in input().split()]\n    A = res = 0\n    for i in range(1, N + 1):\n        A = (A + L[i - 1] % M * max(2, pow(2, i - 1, M))) % M\n        res = (res * 2 % M + A * L[i] % M) % M\n    print(res)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = [int(i) for i in input().split()]\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = ans = 0\n    for i in range(1, n + 1):\n        s = (s + l[i - 1] % mod * max(2, pow(2, i - 1, mod))) % mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input()) + 1\n    l = list(map(int, input().split()))\n    ans = 0\n    s = 0\n    for i in range(1, n):\n        s += l[i - 1] * max(2, pow(2, i - 1, mod)) % mod\n        s %= mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans % mod)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input()) + 1\n    l = list(map(int, input().split()))\n    ans = 0\n    l1 = [pow(2, i, mod) for i in range(n)]\n    l1[0] = 2\n    l2 = [l[i] % mod * l1[i] % mod for i in range(n)]\n    s = 0\n    for i in range(1, n):\n        s += l2[i - 1]\n        s %= mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans % mod)", "mod = 10 ** 9 + 7\nfor t in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    n += 1\n    ans = 0\n    l1 = [pow(2, i, mod) for i in range(n)]\n    l1[0] = 2\n    l2 = [l[i] * l1[i] % mod for i in range(n)]\n    s = 0\n    for i in range(1, n):\n        s += l2[i - 1]\n        s %= mod\n        ans = (ans * 2 % mod + s * l[i] % mod) % mod\n    print(ans % mod)", "try:\n    t = int(input())\n    m = 10 ** 9 + 7\n    for test in range(t):\n        n = int(input())\n        a = list(map(int, input().split()))\n        q = a[0]\n        p = 1\n        s = 0\n        for i in range(1, n + 1):\n            s = (2 * s + 2 * q * a[i]) % m\n            q += p * a[i] % m\n            p = 2 * p % m\n        print(s)\nexcept:\n    pass", "for _ in range(int(input())):\n    N = int(input())\n    A = list(map(int, input().split()))\n    ans = 0\n    c = 2 * A[0]\n    p = 1\n    s = 10 ** 9 + 7\n    for i in range(1, N + 1):\n        p = 2 * p % s\n        ans = (2 * ans + c * A[i]) % s\n        c = (c + p * A[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    N = int(input())\n    A = list(map(int, input().split()))\n    ans = 0\n    c = 2 * A[0]\n    p = 1\n    s = 10 ** 9 + 7\n    for i in range(1, N + 1):\n        p = 2 * p % s\n        ans = (2 * ans + c * A[i]) % s\n        c = (c + p * A[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    N = int(input())\n    A = list(map(int, input().split()))\n    ans = 0\n    c = 2 * A[0]\n    p = 1\n    s = 10 ** 9 + 7\n    for i in range(1, N + 1):\n        p = 2 * p % s\n        ans = (2 * ans + c * A[i]) % s\n        c = (c + p * A[i]) % s\n    print(ans)", "t = int(input())\nfor i in range(t):\n    s = 10 ** 9 + 7\n    n = int(input())\n    l = list(map(int, input().split()))\n    c = 2 * l[0]\n    ans = 0\n    p = 1\n    for j in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + c * l[j]) % s\n        c = (c + p * l[j]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "for _ in range(int(input())):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "t = int(input())\nfor i in range(t):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "t = int(input())\nfor i in range(t):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "t = int(input())\nfor i in range(t):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "t = int(input())\nfor i in range(t):\n    s = 10 ** 9 + 7\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "s = 10 ** 9 + 7\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "s = 10 ** 9 + 7\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "Mod = 10 ** 9 + 7\nfor _ in range(int(input())):\n    n = int(input())\n    arr = list(map(int, input().split()))\n    t = 2 * arr[0]\n    result = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % Mod\n        result = (2 * result + t * arr[i]) % Mod\n        t = (t + p * arr[i]) % Mod\n    print(result)", "Mod = 10 ** 9 + 7\nfor _ in range(int(input())):\n    n = int(input())\n    arr = list(map(int, input().split()))\n    t = 2 * arr[0]\n    result = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % Mod\n        result = (2 * result + t * arr[i]) % Mod\n        t = (t + p * arr[i]) % Mod\n    print(result)", "tc = int(input())\nfor _ in range(tc):\n    X = 1000000007\n    n = int(input())\n    li = list(map(int, input().split()))\n    s = 2 * li[0]\n    ans = 0\n    o = 1\n    for i in range(1, n + 1):\n        o = 2 * o % X\n        ans = (2 * ans + s * li[i]) % X\n        s = (s + o * li[i]) % X\n    print(ans)", "for i in range(int(input())):\n    n = int(input())\n    l = [int(d) for d in input().split()]\n    r = 2 * l[0]\n    c = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % (10 ** 9 + 7)\n        c = (2 * c + r * l[i]) % (10 ** 9 + 7)\n        r = (r + a * l[i]) % (10 ** 9 + 7)\n    print(c)", "t = int(input())\nfor i in range(t):\n    n = int(input())\n    a = [int(j) for j in input().split()]\n    x = 2 * a[0]\n    c = 0\n    y = 1\n    for i in range(1, n + 1):\n        y = 2 * y % (10 ** 9 + 7)\n        c = (2 * c + x * a[i]) % (10 ** 9 + 7)\n        x = (x + y * a[i]) % (10 ** 9 + 7)\n    print(c)", "s = 10 ** 9 + 7\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "n = int(input())\nfor i in range(n):\n    m = int(input())\n    a = list(map(int, input().split()))\n    b = 2 * a[0]\n    sum = 0\n    s = 1\n    for j in range(1, m + 1):\n        s = 2 * s % (10 ** 9 + 7)\n        sum = (2 * sum + b * a[j]) % (10 ** 9 + 7)\n        b = (b + s * a[j]) % (10 ** 9 + 7)\n    print(sum)", "def cal(l, n1):\n    a = 2 * l[0]\n    r = 0\n    p = 1\n    for i in range(1, n1 + 1):\n        p = 2 * p % (10 ** 9 + 7)\n        r = (2 * r + a * l[i]) % (10 ** 9 + 7)\n        a = (a + p * l[i]) % (10 ** 9 + 7)\n    return int(r)\nn = int(input())\nfor i in range(n):\n    a = int(input())\n    l = list(map(int, input().split()))\n    print(cal(l, a))", "def pow(n, pow, mod):\n    if n == 0 or n == 1:\n        return n % mod\n    if pow == 0:\n        return 1\n    if mod == 1:\n        return 0\n    ans = 1\n    while pow:\n        if pow % 2:\n            ans = ans * n % mod\n        n = n * n % mod\n        pow = pow / 2\nmod = 10 ** 9 + 7\nfor i in range(int(input())):\n    n = int(input())\n    arr = [int(i) for i in input().split()]\n    v = 2 * arr[0]\n    c = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % mod\n        c = (2 * c + v * arr[i]) % mod\n        v = (v + a * arr[i]) % mod\n    print(c)", "for tc in range(int(input())):\n    n = int(input())\n    mod = 10 ** 9 + 7\n    lst = [int(x) for x in input().split()]\n    v = 2 * lst[0]\n    c = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % mod\n        c = (2 * c + v * lst[i]) % mod\n        v = (v + a * lst[i]) % mod\n    print(c)", "for i in range(int(input())):\n    n = int(input())\n    l = [int(d) for d in input().split()]\n    v = 2 * l[0]\n    c = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % (10 ** 9 + 7)\n        c = (2 * c + v * l[i]) % (10 ** 9 + 7)\n        v = (v + a * l[i]) % (10 ** 9 + 7)\n    print(c)", "for i in range(int(input())):\n    n = int(input())\n    l = [int(d) for d in input().split()]\n    v = 2 * l[0]\n    c = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % (10 ** 9 + 7)\n        c = (2 * c + v * l[i]) % (10 ** 9 + 7)\n        v = (v + a * l[i]) % (10 ** 9 + 7)\n    print(c)", "for i in range(int(input())):\n    n = int(input())\n    l = [int(d) for d in input().split()]\n    v = 2 * l[0]\n    c = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % (10 ** 9 + 7)\n        c = (2 * c + v * l[i]) % (10 ** 9 + 7)\n        v = (v + a * l[i]) % (10 ** 9 + 7)\n    print(c)", "t = int(input())\nfor _ in range(t):\n    x = 1000000007\n    n = int(input())\n    l = list(map(int, input().split()))\n    sq = 2 * l[0]\n    ans = 0\n    count = 1\n    for i in range(1, n + 1):\n        count = 2 * count % x\n        ans = (2 * ans + sq * l[i]) % x\n        sq = (sq + count * l[i]) % x\n    print(ans)", "t = int(input())\nfor _ in range(t):\n    x = 1000000007\n    n = int(input())\n    l = list(map(int, input().split()))\n    s = 2 * l[0]\n    ans = 0\n    c = 1\n    for i in range(1, n + 1):\n        c = 2 * c % x\n        ans = (2 * ans + s * l[i]) % x\n        s = (s + c * l[i]) % x\n    print(ans)", "n = int(input())\nfor i in range(n):\n    m = int(input())\n    a = list(map(int, input().split()))\n    b = 2 * a[0]\n    sum = 0\n    s = 1\n    for j in range(1, m + 1):\n        s = 2 * s % (10 ** 9 + 7)\n        sum = (2 * sum + b * a[j]) % (10 ** 9 + 7)\n        b = (b + s * a[j]) % (10 ** 9 + 7)\n    print(sum)", "t = int(input())\nfor al in range(t):\n    n = int(input())\n    l = list(map(int, input().split()))\n    x = 2 * l[0]\n    ans = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % (10 ** 9 + 7)\n        ans = (2 * ans + x * l[i]) % (10 ** 9 + 7)\n        x = (x + a * l[i]) % (10 ** 9 + 7)\n    print(ans)", "t = int(input())\nfor al in range(t):\n    n = int(input())\n    l = list(map(int, input().split()))\n    x = 2 * l[0]\n    ans = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % (10 ** 9 + 7)\n        ans = (2 * ans + x * l[i]) % (10 ** 9 + 7)\n        x = (x + a * l[i]) % (10 ** 9 + 7)\n    print(ans)", "t = int(input())\nfor al in range(t):\n    n = int(input())\n    l = list(map(int, input().split()))\n    x = 2 * l[0]\n    ans = 0\n    a = 1\n    for i in range(1, n + 1):\n        a = 2 * a % (10 ** 9 + 7)\n        ans = (2 * ans + x * l[i]) % (10 ** 9 + 7)\n        x = (x + a * l[i]) % (10 ** 9 + 7)\n    print(ans)", "s = 10 ** 9 + 7\nfor _ in range(int(input())):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "s = 10 ** 9 + 7\nfor _ in range(int(input())):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "tc = int(input())\nfor _ in range(tc):\n    X = 1000000007\n    n = int(input())\n    li = list(map(int, input().split()))\n    s = 2 * li[0]\n    ans = 0\n    o = 1\n    for i in range(1, n + 1):\n        o = 2 * o % X\n        ans = (2 * ans + s * li[i]) % X\n        s = (s + o * li[i]) % X\n    print(ans)", "m = 10 ** 9 + 7\nfor j in range(int(input())):\n    num_tests = int(input())\n    a = list(map(int, input().split()))\n    temp = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, num_tests + 1):\n        p = 2 * p % m\n        ans = (2 * ans + temp * a[i]) % m\n        temp = (temp + p * a[i]) % m\n    print(ans)", "tc = int(input())\nfor _ in range(tc):\n    X = 1000000007\n    n = int(input())\n    li = list(map(int, input().split()))\n    s = 2 * li[0]\n    ans = 0\n    o = 1\n    for i in range(1, n + 1):\n        o = 2 * o % X\n        ans = (2 * ans + s * li[i]) % X\n        s = (s + o * li[i]) % X\n    print(ans)", "s = 10 ** 9 + 7\nfor _ in range(int(input())):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "s = 10 ** 9 + 7\nT = int(input())\nfor i in range(T):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % s\n        ans = (2 * ans + t * a[i]) % s\n        t = (t + p * a[i]) % s\n    print(ans)", "m = 10 ** 9 + 7\nT = int(input())\nfor i in range(T):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % m\n        ans = (2 * ans + t * a[i]) % m\n        t = (t + p * a[i]) % m\n    print(ans)", "mod = 10 ** 9 + 7\nT = int(input())\nfor i in range(T):\n    N = int(input())\n    a = [int(x) for x in input().split()]\n    t = 2 * a[0]\n    answer = 0\n    p = 1\n    for i in range(1, N + 1):\n        p = 2 * p % mod\n        answer = (2 * answer + t * a[i]) % mod\n        t = (t + p * a[i]) % mod\n    print(answer)", "MOD = 10 ** 9 + 7\nfor _ in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    s = 2 * a[0]\n    res = 0\n    x = 1\n    for i in range(1, n + 1):\n        x = 2 * x % MOD\n        res = (2 * res + s * a[i]) % MOD\n        s = (s + x * a[i]) % MOD\n    print(res)", "mod = 10 ** 9 + 7\nT = int(input())\nfor i in range(T):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    t = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % mod\n        ans = (2 * ans + t * a[i]) % mod\n        t = (t + p * a[i]) % mod\n    print(ans)", "MOD = 10 ** 9 + 7\nfor _ in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    s = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % MOD\n        ans = (2 * ans + s * a[i]) % MOD\n        s = (s + p * a[i]) % MOD\n    print(ans)", "for t in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    s = 0\n    p = 10 ** 9 + 7\n    b = 2 * a[0]\n    c = 1\n    for i in range(1, n + 1):\n        s = (2 * s % p + b * a[i] % p) % p\n        c = c * 2 % p\n        b = (b % p + c * a[i] % p) % p\n    print(s)", "mod = 10 ** 9 + 7\nfor j in range(int(input())):\n    num_tests = int(input())\n    a = list(map(int, input().split()))\n    temp = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, num_tests + 1):\n        p = 2 * p % mod\n        ans = (2 * ans + temp * a[i]) % mod\n        temp = (temp + p * a[i]) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nT = int(input())\nfor i in range(T):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    temp = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % mod\n        ans = (2 * ans + temp * a[i]) % mod\n        temp = (temp + p * a[i]) % mod\n    print(ans)", "mod = 10 ** 9 + 7\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = [int(x) for x in input().split()]\n    temp = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % mod\n        ans = (2 * ans + temp * a[i]) % mod\n        temp = (temp + p * a[i]) % mod\n    print(ans)", "m = 10 ** 9 + 7\nfor _ in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    s = 2 * a[0]\n    p = 1\n    ans = 0\n    for i in range(1, n + 1):\n        p = 2 * p % m\n        ans = (2 * ans + s * a[i]) % m\n        s = (s + p * a[i]) % m\n    print(int(ans))", "mod = 10 ** 9 + 7\n\ndef rgame(a, n):\n    s = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % mod\n        ans = (2 * ans + s * a[i]) % mod\n        s = (s + p * a[i]) % mod\n    return ans\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    print(rgame(a, n))", "m = 10 ** 9 + 7\nt = int(input())\nfor e in range(t):\n    n = int(input()) + 1\n    l = input().split()\n    (s, temp) = (0, 0)\n    p = pow(2, n - 2, m)\n    for i in range(n):\n        l[i] = int(l[i])\n    for j in range(1, n):\n        pro = pow(2, n - j, m)\n        s = s + pro * l[0] * l[j] % m\n    for j in range(2, n):\n        pro = pow(2, n - j, m)\n        s = s + pro * l[1] * l[j] % m\n        temp = temp + pro * l[j] % m\n    for i in range(2, n):\n        temp = 2 * (temp - l[i] * p) % m\n        s = s + l[i] * temp % m\n    print(s % m)", "from sys import stdin\nm = 10 ** 9 + 7\nt = int(stdin.readline())\nfor e in range(t):\n    n = int(stdin.readline()) + 1\n    l = stdin.readline().split()\n    (s, temp) = (0, 0)\n    p = pow(2, n - 2, m)\n    for i in range(n):\n        l[i] = int(l[i])\n    for j in range(1, n):\n        pro = pow(2, n - j, m)\n        s = s + pro * l[0] * l[j] % m\n    for j in range(2, n):\n        pro = pow(2, n - j, m)\n        s = s + pro * l[1] * l[j] % m\n        temp = temp + pro * l[j] % m\n    for i in range(2, n):\n        temp = 2 * (temp - l[i] * p) % m\n        s = s + l[i] * temp % m\n    print(s % m)", "mod = 10 ** 9 + 7\nfor _ in range(int(input())):\n    sz = int(input())\n    ar = list(map(int, input().split()))\n    s = 2 * ar[0]\n    ans = 0\n    pro = 1\n    for i in range(1, sz + 1):\n        pro = pro * 2 % mod\n        ans = (s * ar[i] + ans * 2) % mod\n        s = (pro * ar[i] + s) % mod\n    print(ans)", "mod = 10 ** 9 + 7\n\ndef solve(l, n):\n    s = 2 * l[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % mod\n        ans = (2 * ans + s * l[i]) % mod\n        s = (s + p * l[i]) % mod\n    return int(ans)\nfor _ in range(int(input())):\n    n = int(input())\n    l = [int(x) for x in input().split()]\n    print(solve(l, n))", "M = 1000000007\nfor _ in range(int(input())):\n    N = int(input())\n    a = list(map(int, input().split()))\n    n1 = a[0]\n    S = 0\n    E = 2 * n1\n    m = 2\n    for i in range(1, N + 1):\n        S = (2 * S + E * a[i]) % M\n        E = (E + m * a[i]) % M\n        m = 2 * m % M\n    print(S)", "try:\n    m = 10 ** 9 + 7\n\n    def rg(l, n):\n        r = 2 * l[0]\n        sol = 0\n        g = 1\n        for i in range(1, n + 1):\n            g = 2 * g % m\n            sol = (2 * sol + r * l[i]) % m\n            r = (r + g * l[i]) % m\n        return sol\n    for i in range(int(input())):\n        n = int(input())\n        l = list(map(int, input().split()))\n        print(rg(l, n))\nexcept:\n    pass", "try:\n    mod = 10 ** 9 + 7\n\n    def rgame(a, n):\n        s = 2 * a[0]\n        ans = 0\n        p = 1\n        for i in range(1, n + 1):\n            p = 2 * p % mod\n            ans = (2 * ans + s * a[i]) % mod\n            s = (s + p * a[i]) % mod\n        return ans\n    t = int(input())\n    for i in range(t):\n        n = int(input())\n        a = list(map(int, input().split()))\n        print(rgame(a, n))\nexcept:\n    pass", "mod = 10 ** 9 + 7\nn = int(input())\nwhile n > 0:\n    n -= 1\n    x = int(input())\n    lis = list(map(int, input().split()))\n    (q, res) = (1, 0)\n    c = lis[0]\n    for i in range(1, x + 1):\n        res = (2 * res + c * lis[i] * 2) % mod\n        c = (c + q * lis[i]) % mod\n        q = 2 * q % mod\n    print(res)", "mod = 10 ** 9 + 7\nn = int(input())\nwhile n > 0:\n    n -= 1\n    x = int(input())\n    lis = list(map(int, input().split()))\n    (q, res) = (1, 0)\n    c = lis[0]\n    for i in range(1, x + 1):\n        res = (2 * res + c * lis[i] * 2) % mod\n        c = (c + q * lis[i]) % mod\n        q = 2 * q % mod\n    print(res)", "mod = 10 ** 9 + 7\n\ndef rgame(a, n):\n    s = 2 * a[0]\n    ans = 0\n    p = 1\n    for i in range(1, n + 1):\n        p = 2 * p % mod\n        ans = (2 * ans + s * a[i]) % mod\n        s = (s + p * a[i]) % mod\n    return ans\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    print(rgame(a, n))"]