["t = int(input())\nfor i in range(t):\n    n = int(input())\n    arr = []\n    for k in range(n):\n        a = [int(z) for z in input().split(' ')]\n        a.sort()\n        arr.append(a)\n    old = 10 ** 9 + 1\n    c = 0\n    sumo = 0\n    for k in range(n - 1, -1, -1):\n        for z in range(n - 1, -1, -1):\n            val = arr[k][z]\n            if val < old:\n                sumo += val\n                c += 1\n                old = val\n                break\n    if c == n:\n        print(sumo)\n    else:\n        print(-1)", "t = int(input())\nfor i in range(t):\n    n = int(input())\n    arr = []\n    for k in range(n):\n        a = [int(z) for z in input().split(' ')]\n        a.sort()\n        arr.append(a)\n    old = 10 ** 9 + 1\n    c = 0\n    sumo = 0\n    for k in range(n - 1, -1, -1):\n        for z in range(n - 1, -1, -1):\n            val = arr[k][z]\n            if val < old:\n                sumo += val\n                c += 1\n                old = val\n                break\n    if c == n:\n        print(sumo)\n    else:\n        print(-1)", "for _ in range(int(input())):\n    n = int(input())\n    a = []\n    for i in range(n):\n        t = list(map(int, input().split()))\n        t.sort(reverse=True)\n        a.append(t)\n    a.reverse()\n    f = a[0][0]\n    count = 1\n    mx = f\n    for i in range(1, n):\n        for j in range(n):\n            if a[i][j] < mx:\n                f += a[i][j]\n                count += 1\n                mx = a[i][j]\n                break\n    if count == n:\n        print(f)\n    else:\n        print(-1)", "for _ in range(int(input())):\n    n = int(input())\n    a = []\n    for i in range(n):\n        t = list(map(int, input().split()))\n        t.sort(reverse=True)\n        a.append(t)\n    a.reverse()\n    f = a[0][0]\n    count = 1\n    mx = f\n    for i in range(1, n):\n        for j in range(n):\n            if a[i][j] < mx:\n                f += a[i][j]\n                count += 1\n                mx = a[i][j]\n                break\n    if count == n:\n        print(f)\n    else:\n        print(-1)", "t = int(input())\nwhile t > 0:\n    n = int(input())\n    mat = []\n    for _ in range(n):\n        s = input().split()\n        arr = [int(x) for x in s]\n        arr.sort(reverse=True)\n        mat.append(arr)\n    mat.reverse()\n    curr = mat[0][0]\n    summ = curr\n    counter = 1\n    for i in range(1, n):\n        for el in mat[i]:\n            if el < curr:\n                summ += el\n                curr = el\n                counter += 1\n                break\n    if counter == n:\n        print(summ)\n    else:\n        print(-1)\n    t -= 1", "t = int(input())\nwhile t > 0:\n    n = int(input())\n    mat = []\n    for _ in range(n):\n        s = input().split()\n        arr = [int(x) for x in s]\n        arr.sort(reverse=True)\n        mat.append(arr)\n    mat.reverse()\n    curr = mat[0][0]\n    summ = curr\n    counter = 1\n    for i in range(1, n):\n        for el in mat[i]:\n            if el < curr:\n                summ += el\n                curr = el\n                counter += 1\n                break\n    if counter == n:\n        print(summ)\n    else:\n        print(-1)\n    t -= 1", "t = int(input())\nwhile t > 0:\n    n = int(input())\n    mat = []\n    for _ in range(n):\n        s = input().split()\n        arr = [int(x) for x in s]\n        arr.sort(reverse=True)\n        mat.append(arr)\n    mat.reverse()\n    curr = mat[0][0]\n    summ = curr\n    counter = 1\n    for i in range(1, n):\n        for el in mat[i]:\n            if el < curr:\n                summ += el\n                curr = el\n                counter += 1\n                break\n    if counter == n:\n        print(summ)\n    else:\n        print(-1)\n    t -= 1", "for _ in range(int(input())):\n    n = int(input())\n    lst = []\n    for i in range(n):\n        lst.append(list(map(int, input().split())))\n    l = []\n    prev = 1000000001\n    for i in lst[::-1]:\n        m = 0\n        bl = False\n        for j in i:\n            if j < prev:\n                m = max(j, m)\n                bl = True\n        if bl:\n            l.append(m)\n            prev = m\n        else:\n            break\n    if len(l) == n:\n        print(sum(l))\n    else:\n        print(-1)", "for _ in range(int(input())):\n    n = int(input())\n    score = []\n    for i in range(n):\n        a = list(map(int, input().split()))\n        a.sort()\n        score.append(a)\n    score = score[::-1]\n    maxx = max(score[0])\n    p = max(score[0])\n    for j in range(1, len(score)):\n        b = score[j]\n        b = sorted(b, reverse=True)\n        for value in b:\n            if value < p:\n                maxx += value\n                p = value\n                break\n        else:\n            maxx = -1\n            break\n    print(maxx)", "for _ in range(int(input())):\n    n = int(input())\n    score = []\n    for i in range(n):\n        a = list(map(int, input().split()))\n        a.sort()\n        score.append(a)\n    score = score[::-1]\n    maxx = max(score[0])\n    p = max(score[0])\n    for j in range(1, len(score)):\n        b = score[j]\n        b = sorted(b, reverse=True)\n        for value in b:\n            if value < p:\n                maxx += value\n                p = value\n                break\n        else:\n            maxx = -1\n            break\n    print(maxx)", "for _ in range(int(input())):\n    n = int(input())\n    score = []\n    for i in range(n):\n        a = list(map(int, input().split()))\n        a.sort()\n        score.append(a)\n    score = score[::-1]\n    maxx = max(score[0])\n    p = max(score[0])\n    for j in range(1, len(score)):\n        b = score[j]\n        b = sorted(b, reverse=True)\n        for value in b:\n            if value < p:\n                maxx += value\n                p = value\n                break\n        else:\n            maxx = -1\n            break\n    print(maxx)", "for _ in range(int(input())):\n    n = int(input())\n    score = []\n    for i in range(n):\n        a = list(map(int, input().split()))\n        a.sort()\n        score.append(a)\n    score = score[::-1]\n    maxx = max(score[0])\n    p = max(score[0])\n    for j in range(1, len(score)):\n        b = score[j]\n        b = sorted(b, reverse=True)\n        for value in b:\n            if value < p:\n                maxx += value\n                p = value\n                break\n        else:\n            maxx = -1\n            break\n    print(maxx)", "for _ in range(int(input())):\n    n = int(input())\n    arr = []\n    for i in range(n):\n        arr.append([int(i) for i in input().split()])\n    ex = [max(arr[n - 1])]\n    for i in range(n - 2, -1, -1):\n        e = -1\n        for j in range(n - 1, -1, -1):\n            if arr[i][j] < ex[len(ex) - 1]:\n                e = max(e, arr[i][j])\n        if e == -1:\n            print(-1)\n            break\n        else:\n            ex.append(e)\n    else:\n        print(sum(ex))", "for _ in range(int(input())):\n    n = int(input())\n    mat = []\n    for _ in range(n):\n        mat.append(sorted([int(a) for a in input().split()]))\n    mat = mat[::-1]\n    ans = max(mat[0])\n    p = max(mat[0])\n    for k in range(1, len(mat)):\n        test = mat[k][::-1]\n        f = False\n        for val in test:\n            if val < p:\n                ans = ans + val\n                f = True\n                p = val\n                break\n        else:\n            print(-1)\n            break\n    if f:\n        print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    l = []\n    if n == 1:\n        s = int(input())\n        print(s)\n    else:\n        for i in range(n):\n            a = list(map(int, input().split()))\n            a.sort()\n            l.append(a)\n        m = l[-1][-1]\n        flag = 1\n        sum = m\n        for j in range(n - 2, -1, -1):\n            b = False\n            for k in range(n - 1, -1, -1):\n                if l[j][k] < m:\n                    m = l[j][k]\n                    sum += m\n                    b = True\n                    break\n            if b == False:\n                break\n        if not b:\n            print(-1)\n        else:\n            print(sum)", "for _ in range(int(input())):\n    n = int(input())\n    l = []\n    if n == 1:\n        s = int(input())\n        print(s)\n    else:\n        for i in range(n):\n            a = list(map(int, input().split()))\n            a.sort()\n            l.append(a)\n        m = l[-1][-1]\n        flag = 1\n        sum = m\n        for j in range(n - 2, -1, -1):\n            b = False\n            for k in range(n - 1, -1, -1):\n                if l[j][k] < m:\n                    m = l[j][k]\n                    sum += m\n                    b = True\n                    break\n            if b == False:\n                break\n        if not b:\n            print(-1)\n        else:\n            print(sum)", "for _ in range(int(input())):\n    n = int(input())\n    l = []\n    if n == 1:\n        s = int(input())\n        print(s)\n    else:\n        for i in range(n):\n            a = list(map(int, input().split()))\n            a.sort()\n            l.append(a)\n        m = l[-1][-1]\n        flag = 1\n        sum = m\n        for j in range(n - 2, -1, -1):\n            b = False\n            for k in range(n - 1, -1, -1):\n                if l[j][k] < m:\n                    m = l[j][k]\n                    sum += m\n                    b = True\n                    break\n            if b == False:\n                break\n        if not b:\n            print(-1)\n        else:\n            print(sum)", "for _ in range(int(input())):\n    n = int(input())\n    A = list()\n    for i in range(n):\n        A.append(sorted(list(map(int, input().split())), reverse=True))\n    Ans = A[n - 1][0]\n    prev = Ans\n    flag = False\n    for i in range(n - 2, -1, -1):\n        flag = True\n        for j in A[i]:\n            if j < prev:\n                flag = False\n                Ans += j\n                prev = j\n                break\n        if flag:\n            break\n    if flag:\n        print(-1)\n    else:\n        print(Ans)", "for _ in range(int(input())):\n    n = int(input())\n    arr = []\n    for i in range(n):\n        arr.append(list(map(int, input().split())))\n    for i in range(n):\n        arr[i].sort()\n    m = arr[n - 1][n - 1]\n    ans = arr[n - 1][n - 1]\n    f = 1\n    for i in range(n - 2, -1, -1):\n        for j in range(n - 1, -1, -1):\n            if arr[i][j] < m:\n                m = arr[i][j]\n                ans += m\n                break\n            if j == 0:\n                f = 0\n                break\n    if f:\n        print(ans)\n    else:\n        print(-1)", "for _ in range(int(input())):\n    n = int(input())\n    a = []\n    for i in range(n):\n        x = list(map(int, input().split()))\n        x.sort()\n        a.append(x)\n    m = max(a[-1])\n    s = m\n    c = 1\n    for i in range(n - 2, -1, -1):\n        for j in range(len(a[i]) - 1, -1, -1):\n            if a[i][j] < m:\n                m = a[i][j]\n                s += m\n                c += 1\n                break\n    if c == n:\n        print(s)\n    else:\n        print(-1)", "T = int(input())\nfor t in range(T):\n    N = int(input())\n    matrix = []\n    for n in range(N):\n        matrix.append([int(i) for i in input().split()])\n    E = [max(matrix[N - 1])]\n    for i in range(N - 2, -1, -1):\n        e = -1\n        for j in range(N - 1, -1, -1):\n            if matrix[i][j] < E[len(E) - 1]:\n                e = max(e, matrix[i][j])\n        if e == -1:\n            print(-1)\n            break\n        else:\n            E.append(e)\n    else:\n        print(sum(E))", "import numpy as np\nfor _ in range(int(input())):\n    n = int(input())\n    arr = np.zeros((n, n), int)\n    for i in range(n):\n        line = np.array(list(map(int, input().split())))\n        arr[i] = line\n    s = 0\n    previous = 1000000000.0 + 1\n    for row in range(n - 1, -1, -1):\n        previous = max((arr[row] < previous) * arr[row])\n        if previous == 0:\n            s = -1\n            break\n        s += previous\n    print(s)", "T = int(input())\nfor t in range(T):\n    N = int(input())\n    matrix = []\n    for n in range(N):\n        matrix.append([int(i) for i in input().split()])\n    E = [max(matrix[N - 1])]\n    for i in range(N - 2, -1, -1):\n        e = -1\n        for j in range(N - 1, -1, -1):\n            if matrix[i][j] < E[len(E) - 1]:\n                e = max(e, matrix[i][j])\n        if e == -1:\n            print(-1)\n            break\n        else:\n            E.append(e)\n    else:\n        print(sum(E))", "T = int(input())\nfor t in range(T):\n    N = int(input())\n    matrix = []\n    for n in range(N):\n        matrix.append([int(i) for i in input().split()])\n    E = [max(matrix[N - 1])]\n    for i in range(N - 2, -1, -1):\n        e = -1\n        for j in range(N - 1, -1, -1):\n            if matrix[i][j] < E[len(E) - 1]:\n                e = max(e, matrix[i][j])\n        if e == -1:\n            print(-1)\n            break\n        else:\n            E.append(e)\n    else:\n        print(sum(E))", "t = int(input())\nfor i in range(t):\n    a = int(input())\n    b = []\n    c = []\n    f = 0\n    for j in range(a):\n        b = list(map(int, input().split()))\n        c.append(b)\n    m = max(c[-1])\n    s = m\n    for k in range(a - 2, -1, -1):\n        d = []\n        for z in c[k]:\n            if z < m:\n                d.append(z)\n        if len(d) > 0:\n            m = max(d)\n        else:\n            f = -1\n        s += m\n    print(s if f == 0 else -1)", "t = int(input())\nfor i in range(t):\n    a = int(input())\n    b = []\n    c = []\n    f = 0\n    for j in range(a):\n        b = list(map(int, input().split()))\n        c.append(b)\n    m = max(c[-1])\n    s = m\n    for k in range(a - 2, -1, -1):\n        d = []\n        for z in c[k]:\n            if z < m:\n                d.append(z)\n        if len(d) > 0:\n            m = max(d)\n        else:\n            f = -1\n        s += m\n    print(s if f == 0 else -1)", "T = int(input())\nfor t in range(T):\n    N = int(input())\n    matrix = []\n    for n in range(N):\n        matrix.append([int(i) for i in input().split()])\n    E = [max(matrix[N - 1])]\n    for i in range(N - 2, -1, -1):\n        e = -1\n        for j in range(N - 1, -1, -1):\n            if matrix[i][j] < E[len(E) - 1]:\n                e = max(e, matrix[i][j])\n        if e == -1:\n            print(-1)\n            break\n        else:\n            E.append(e)\n    else:\n        print(sum(E))", "t = int(input())\nfor i in range(t):\n    a = int(input())\n    b = []\n    c = []\n    f = 0\n    for j in range(a):\n        b = list(map(int, input().split()))\n        c.append(b)\n    m = max(c[-1])\n    s = m\n    for k in range(a - 2, -1, -1):\n        d = []\n        for z in c[k]:\n            if z < m:\n                d.append(z)\n        if len(d) > 0:\n            m = max(d)\n        else:\n            f = -1\n        s += m\n    print(s if f == 0 else -1)", "for i in range(int(input())):\n    a = int(input())\n    b = []\n    c = []\n    cnt = 0\n    fl = 0\n    for i in range(a):\n        b = list(map(int, input().split()))\n        c.append(b)\n    mx = max(c[-1])\n    sm = mx\n    for i in range(a - 2, -1, -1):\n        d = []\n        for j in c[i]:\n            if j < mx:\n                d.append(j)\n        if len(d) > 0:\n            mx = max(d)\n        else:\n            fl = -1\n        sm += mx\n    if fl == 0:\n        print(sm)\n    else:\n        print(-1)", "for i in range(int(input())):\n    a = int(input())\n    b = []\n    c = []\n    cnt = 0\n    fl = 0\n    for i in range(a):\n        b = list(map(int, input().split()))\n        c.append(b)\n    mx = max(c[-1])\n    sm = mx\n    for i in range(a - 2, -1, -1):\n        d = []\n        for j in c[i]:\n            if j < mx:\n                d.append(j)\n        if len(d) > 0:\n            mx = max(d)\n        else:\n            fl = -1\n        sm += mx\n    if fl == 0:\n        print(sm)\n    else:\n        print(-1)", "for i in range(int(input())):\n    a = int(input())\n    b = []\n    c = []\n    cnt = 0\n    fl = 0\n    for i in range(a):\n        b = list(map(int, input().split()))\n        c.append(b)\n    mx = max(c[-1])\n    sm = mx\n    for i in range(a - 2, -1, -1):\n        d = []\n        for j in c[i]:\n            if j < mx:\n                d.append(j)\n        if len(d) > 0:\n            mx = max(d)\n        else:\n            fl = -1\n        sm += mx\n    if fl == 0:\n        print(sm)\n    else:\n        print(-1)", "T = int(input())\nfor t in range(T):\n    N = int(input())\n    matrix = []\n    for n in range(N):\n        matrix.append([int(i) for i in input().split()])\n    E = [max(matrix[N - 1])]\n    for i in range(N - 2, -1, -1):\n        e = -1\n        for j in range(N - 1, -1, -1):\n            if matrix[i][j] < E[len(E) - 1]:\n                e = max(e, matrix[i][j])\n        if e == -1:\n            print(-1)\n            break\n        else:\n            E.append(e)\n    else:\n        print(sum(E))", "for _ in range(int(input())):\n    n = int(input())\n    ali = []\n    for i in range(n):\n        li = list(map(int, input().split()))\n        ali.append(li)\n    mx = max(ali[-1])\n    sem = mx\n    try:\n        for i in range(n - 2, -1, -1):\n            mx = max([j for j in ali[i] if j < mx])\n            sem += mx\n        print(sem)\n    except ValueError:\n        print(-1)", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    grid = []\n    for _ in range(n):\n        temp = []\n        temp = list(map(int, input().strip().split()))\n        temp.sort()\n        grid.append(temp)\n    curr = max(grid[n - 1])\n    total = curr\n    for i in range(n - 2, 0 - 1, -1):\n        flag = 0\n        for j in range(n - 1, 0 - 1, -1):\n            if grid[i][j] < curr:\n                flag = 1\n                curr = grid[i][j]\n                total += curr\n                break\n        if flag == 0:\n            total = -1\n            break\n    print(total)", "import bisect\nfor _ in range(int(input())):\n    N = int(input())\n    M = []\n    for i in range(N):\n        A = list(map(int, input().split()))\n        A.sort()\n        M.append(A)\n    E = [M[-1][-1]]\n    for i in range(N - 2, -1, -1):\n        j = bisect.bisect_left(M[i], E[-1]) - 1\n        if j < 0:\n            break\n        E.append(M[i][j])\n    if len(E) < N:\n        print(-1)\n    else:\n        print(sum(E))", "for _ in range(int(input())):\n    n = int(input())\n    ali = []\n    for i in range(n):\n        li = list(map(int, input().split()))\n        ali.append(li)\n    mx = max(ali[-1])\n    sem = mx\n    try:\n        for i in range(n - 2, -1, -1):\n            mx = max([j for j in ali[i] if j < mx])\n            sem += mx\n        print(sem)\n    except ValueError:\n        print(-1)", "t = int(input())\nfor _ in range(t):\n    arr = []\n    n = int(input())\n    for _ in range(n):\n        arr.append(list(map(int, input().split(' '))))\n    mx = max(arr[-1])\n    sem = mx\n    try:\n        for i in range(n - 2, -1, -1):\n            mx = max([j for j in arr[i] if j < mx])\n            sem += mx\n        print(sem)\n    except ValueError:\n        print(-1)", "for _ in range(int(input())):\n    n = int(input())\n    ali = []\n    for i in range(n):\n        li = list(map(int, input().split()))\n        ali.append(li)\n    mx = max(ali[-1])\n    sem = mx\n    try:\n        for i in range(n - 2, -1, -1):\n            mx = max([j for j in ali[i] if j < mx])\n            sem += mx\n        print(sem)\n    except ValueError:\n        print(-1)", "for _ in range(int(input())):\n    n = int(input())\n    mat = []\n    for _ in range(n):\n        mat.append(sorted([int(a) for a in input().split()]))\n    mat = mat[::-1]\n    ans = max(mat[0])\n    p = max(mat[0])\n    for k in range(1, len(mat)):\n        test = mat[k][::-1]\n        f = False\n        for val in test:\n            if val < p:\n                ans = ans + val\n                f = True\n                p = val\n                break\n        if not f:\n            print(-1)\n            break\n    if f:\n        print(ans)", "for i in range(int(input())):\n    n = int(input())\n    rows = []\n    for i in range(n):\n        rows.append(list(map(int, input().split())))\n    c = max(rows[-1])\n    add = c\n    try:\n        for j in range(n - 2, -1, -1):\n            c = max([i for i in rows[j] if i < c])\n            add += c\n        print(add)\n    except ValueError:\n        print(-1)", "import sys\nntests = int(sys.stdin.readline().strip())\nwhile ntests > 0:\n    ntests -= 1\n    N = int(sys.stdin.readline().strip())\n    state = [(0, 0)]\n    for r in range(0, N):\n        fields = list(map(int, sys.stdin.readline().strip().split()))\n        fields.sort()\n        i = len(state) - 1\n        j = len(fields) - 1\n        nstate = []\n        while i >= 0 and j >= 0:\n            if fields[j] > state[i][0]:\n                nstate.insert(0, (fields[j], fields[j] + state[i][1]))\n                j -= 1\n            else:\n                i -= 1\n        state = nstate\n    if len(state) > 0:\n        print(state[-1][1])\n    else:\n        print('-1')", "def score(qn):\n    import math\n    maximum = math.inf\n    score = 0\n    for i in reversed(range(0, len(qn))):\n        temp = -1\n        for j in qn[i]:\n            if j > temp and j < maximum:\n                temp = j\n        if temp == -1:\n            return -1\n        else:\n            score += temp\n            maximum = temp\n    return score\nimport sys\nc = 0\nfor line in sys.stdin:\n    if c == 0:\n        t = int(line.strip())\n        c = 2\n    elif c % 2 == 0:\n        new = line.split()\n        N = int(new[0].strip())\n        qn = []\n        c = 5\n        count = 1\n    elif c == 5:\n        a = list(map(int, line.split()))\n        qn.append(a)\n        count += 1\n        if count == N + 1:\n            c = 2\n            print(score(qn))", "T = int(input())\nfor i in range(T):\n    n = int(input())\n    a = []\n    for j in range(n):\n        temp = []\n        temp = list(map(int, input().strip().split()))\n        temp.sort()\n        a.append(temp)\n    curr = max(a[n - 1])\n    total = curr\n    for i in range(n - 2, 0 - 1, -1):\n        flag = 0\n        for j in range(n - 1, 0 - 1, -1):\n            if a[i][j] < curr:\n                flag = 1\n                curr = a[i][j]\n                total += curr\n                break\n        if flag == 0:\n            total = -1\n            break\n    print(total)", "import math\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = [0] * n\n    for i in range(n):\n        arr[i] = list(map(int, input().split()))\n        arr[i].sort()\n    cmax = 0\n    curr = 0\n    cbefore = math.inf\n    for i in range(n - 1, -1, -1):\n        ik = n - 1\n        karr = arr[i]\n        curr = karr[ik]\n        while curr >= cbefore:\n            ik = ik - 1\n            if ik < 0:\n                cmax = -1\n                break\n            curr = karr[ik]\n        if cmax == -1:\n            break\n        cmax += curr\n        cbefore = curr\n    print(cmax)", "for i in range(int(input())):\n    nm = int(input())\n    lst = []\n    for j in range(nm):\n        lst.append(sorted([int(x) for x in input().split()]))\n    sm = lst[-1][-1]\n    mx = lst[-1][-1]\n    c = 1\n    for m in range(nm - 2, -1, -1):\n        for n in range(nm - 1, -1, -1):\n            if lst[m][n] < mx:\n                sm += lst[m][n]\n                mx = lst[m][n]\n                c += 1\n                break\n    if c == nm:\n        print(sm)\n    else:\n        print(-1)", "T = int(input())\nfor i in range(T):\n    n = int(input())\n    grid = []\n    for j in range(n):\n        temp = []\n        temp = list(map(int, input().strip().split()))\n        temp.sort()\n        grid.append(temp)\n    curr = max(grid[n - 1])\n    total = curr\n    for i in range(n - 2, 0 - 1, -1):\n        flag = 0\n        for j in range(n - 1, 0 - 1, -1):\n            if grid[i][j] < curr:\n                flag = 1\n                curr = grid[i][j]\n                total += curr\n                break\n        if flag == 0:\n            total = -1\n            break\n    print(total)", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    grid = []\n    for _ in range(n):\n        temp = []\n        temp = list(map(int, input().strip().split()))\n        temp.sort()\n        grid.append(temp)\n    curr = max(grid[n - 1])\n    total = curr\n    for i in range(n - 2, 0 - 1, -1):\n        flag = 0\n        for j in range(n - 1, 0 - 1, -1):\n            if grid[i][j] < curr:\n                flag = 1\n                curr = grid[i][j]\n                total += curr\n                break\n        if flag == 0:\n            total = -1\n            break\n    print(total)", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    grid = []\n    for _ in range(n):\n        temp = []\n        temp = list(map(int, input().strip().split()))\n        temp.sort()\n        grid.append(temp)\n    curr = max(grid[n - 1])\n    total = curr\n    for i in range(n - 2, 0 - 1, -1):\n        flag = 0\n        for j in range(n - 1, 0 - 1, -1):\n            if grid[i][j] < curr:\n                flag = 1\n                curr = grid[i][j]\n                total += curr\n                break\n        if flag == 0:\n            total = -1\n            break\n    print(total)", "for _ in range(int(input())):\n    n = int(input())\n    mat = []\n    for x in range(n):\n        mat.append([int(i) for i in input().split()])\n    ans = [0] * n\n    flag = True\n    ans[-1] = max(mat[-1])\n    for i in range(n - 2, -1, -1):\n        for ele in mat[i]:\n            if ele < ans[i + 1]:\n                ans[i] = max(ans[i], ele)\n        if ans[i] == 0:\n            flag = False\n            break\n    if flag:\n        print(sum(ans))\n    else:\n        print(-1)", "t = int(input())\nfor cases in range(t):\n    n = int(input())\n    lis = []\n    for i in range(n):\n        lis1 = sorted(list(map(int, input().split())))\n        lis.append(lis1)\n    summ = lis[-1][-1]\n    maxx = summ\n    c = 1\n    for i in range(n - 2, -1, -1):\n        for j in range(n - 1, -1, -1):\n            if lis[i][j] < maxx:\n                maxx = lis[i][j]\n                c += 1\n                summ += lis[i][j]\n                break\n    if c == n:\n        print(summ)\n    else:\n        print(-1)\n    print()", "def largest_smaller_than(a, N, key):\n    start = 0\n    end = N\n    ans = -1\n    while end >= start:\n        mid = (start + end) // 2\n        if mid >= N or mid < 0:\n            break\n        elif a[mid] < key:\n            ans = mid\n            start = mid + 1\n        elif a[mid] >= key:\n            end = mid - 1\n    if ans != -1:\n        return a[ans]\n    else:\n        return -1\nT = int(input())\nans = []\nfor _ in range(T):\n    N = int(input())\n    A = []\n    for i in range(N):\n        x = [int(i) for i in input().split()]\n        A.append(sorted(x))\n    start = float('inf')\n    sum = 0\n    for i in range(N - 1, -1, -1):\n        start = largest_smaller_than(A[i], N, start)\n        if start == -1:\n            sum = -1\n            break\n        sum += start\n    ans.append(sum)\nfor i in ans:\n    print(i)", "try:\n    for i in range(int(input())):\n        nm = int(input())\n        lst = []\n        for j in range(nm):\n            lst.append(sorted([int(x) for x in input().split()]))\n        sm = lst[-1][-1]\n        mx = lst[-1][-1]\n        c = 1\n        for m in range(nm - 2, -1, -1):\n            for n in range(nm - 1, -1, -1):\n                if lst[m][n] < mx:\n                    sm += lst[m][n]\n                    mx = lst[m][n]\n                    c += 1\n                    break\n        if c == nm:\n            print(sm)\n        else:\n            print(-1)\nexcept:\n    pass", "for i in range(int(input())):\n    nm = int(input())\n    lst = []\n    for j in range(nm):\n        lst.append(sorted([int(x) for x in input().split()]))\n    sm = lst[-1][-1]\n    mx = lst[-1][-1]\n    c = 1\n    for m in range(nm - 2, -1, -1):\n        for n in range(nm - 1, -1, -1):\n            if lst[m][n] < mx:\n                sm += lst[m][n]\n                mx = lst[m][n]\n                c += 1\n                break\n    if c == nm:\n        print(sm)\n    else:\n        print(-1)", "for _ in range(int(input())):\n    n = int(input())\n    s = 0\n    m = []\n    for i in range(n):\n        l = []\n        l = [int(i) for i in input().split()]\n        l.sort()\n        m.append(l)\n    answer = m[n - 1][n - 1]\n    last = m[n - 1][n - 1]\n    s = 1\n    for i in range(n - 2, -1, -1):\n        for j in range(n - 1, -1, -1):\n            if m[i][j] < last:\n                answer += m[i][j]\n                last = m[i][j]\n                s += 1\n                break\n    if s == n:\n        print(answer)\n    else:\n        print(-1)", "for _ in range(int(input())):\n    n = int(input())\n    s = 0\n    mat = []\n    for i in range(n):\n        a = []\n        a = [int(i) for i in input().split()]\n        a.sort()\n        mat.append(a)\n    ans = mat[n - 1][n - 1]\n    last = mat[n - 1][n - 1]\n    s = 1\n    for i in range(n - 2, -1, -1):\n        for j in range(n - 1, -1, -1):\n            if mat[i][j] < last:\n                ans += mat[i][j]\n                last = mat[i][j]\n                s += 1\n                break\n    if s == n:\n        print(ans)\n    else:\n        print(-1)", "for _ in range(int(input())):\n    a = []\n    n = int(input())\n    for t in range(n):\n        p = list(map(int, input().split()))\n        a.append(p)\n    c = [0] * n\n    c[n - 1] = max(a[n - 1])\n    f = 0\n    s = 0\n    for i in range(n - 2, -1, -1):\n        c[i] = 0\n        for j in range(n):\n            if a[i][j] < c[i + 1]:\n                c[i] = max(c[i], a[i][j])\n        if c[i] == 0:\n            f = 1\n            break\n        else:\n            s += c[i]\n    if f == 1:\n        print(-1)\n    else:\n        print(s + c[n - 1])", "for _ in range(int(input())):\n    a = []\n    n = int(input())\n    for t in range(n):\n        p = list(map(int, input().split()))\n        a.append(p)\n    c = [0] * n\n    c[n - 1] = max(a[n - 1])\n    f = 0\n    s = 0\n    for i in range(n - 2, -1, -1):\n        c[i] = 0\n        for j in range(n):\n            if a[i][j] < c[i + 1]:\n                c[i] = max(c[i], a[i][j])\n        if c[i] == 0:\n            f = 1\n            break\n        else:\n            s += c[i]\n    if f == 1:\n        print(-1)\n    else:\n        print(s + c[n - 1])", "for _ in range(int(input())):\n    n = int(input())\n    l = []\n    for i in range(n):\n        l1 = list(map(int, input().split()))\n        l1.sort()\n        l.append(l1)\n    ans = l1[-1]\n    p = ans\n    for i in range(n - 2, -1, -1):\n        flag = 0\n        for j in range(n - 1, -1, -1):\n            if l[i][j] < p:\n                p = l[i][j]\n                ans += p\n                flag = 1\n                break\n        if flag == 0:\n            print(-1)\n            flag = 2\n            break\n    if flag != 2:\n        print(ans)", "for i in range(int(input())):\n    n = int(input())\n    b = []\n    counter = 0\n    for j in range(n):\n        b.append(list(map(int, input().split())))\n    c = max(b[-1])\n    sum = c\n    for k in range(1, n):\n        for x in b[-k - 1]:\n            if x < c and x > counter:\n                counter = x\n        if counter == 0:\n            print(-1)\n            sum = 0\n            break\n        else:\n            sum = sum + counter\n            c = counter\n            counter = 0\n    if sum != 0:\n        print(sum)", "def maxScore():\n    for t in range(int(input())):\n        n = int(input())\n        l = []\n        for i in range(n):\n            temp = sorted([int(x) for x in input().split()])\n            l.append(temp)\n        s = l[n - 1][n - 1]\n        cdt_o = l[n - 1][n - 1]\n        for i in range(n - 2, -1, -1):\n            success = 1\n            for j in range(n - 1, -1, -1):\n                cdt_t = l[i][j]\n                if cdt_t < cdt_o:\n                    s += cdt_t\n                    cdt_o = cdt_t\n                    break\n                elif j == 0:\n                    success = 0\n                    break\n                elif cdt_t >= cdt_o:\n                    continue\n            if success == 0:\n                break\n        if success == 0:\n            print(-1)\n        else:\n            print(s)\nmaxScore()", "def score(qn):\n    import math\n    maximum = math.inf\n    score = 0\n    for i in reversed(range(0, len(qn))):\n        temp = -1\n        for j in qn[i]:\n            if j > temp and j < maximum:\n                temp = j\n        if temp == -1:\n            return -1\n        else:\n            score += temp\n            maximum = temp\n    return score\nimport sys\nc = 0\nfor line in sys.stdin:\n    if c == 0:\n        t = int(line.strip())\n        c = 2\n    elif c % 2 == 0:\n        new = line.split()\n        N = int(new[0].strip())\n        qn = []\n        c = 5\n        count = 1\n    elif c == 5:\n        a = list(map(int, line.split()))\n        qn.append(a)\n        count += 1\n        if count == N + 1:\n            c = 2\n            print(score(qn))", "testCases = int(input())\nlines = 0\nfor _ in range(testCases):\n    lines = int(input())\n    arr = []\n    for _ in range(lines):\n        arr.append(sorted(list(map(int, input().split())), reverse=True))\n    maximum = max(arr[lines - 1])\n    choosen = maximum\n    bool = True\n    for index in range(lines - 2, -1, -1):\n        secondBool = True\n        for j in range(lines):\n            if arr[index][j] < maximum:\n                choosen += arr[index][j]\n                maximum = arr[index][j]\n                secondBool = False\n                break\n        if secondBool == True:\n            bool = False\n            break\n    if bool == True:\n        print(choosen)\n    else:\n        print(-1)", "test = int(input())\nfor _ in range(test):\n    n = int(input())\n    ls = []\n    for _ in range(n):\n        ls.append(sorted(list(map(int, input().split())), reverse=True))\n    m = max(ls[n - 1])\n    s = m\n    d = 0\n    for i in range(n - 2, -1, -1):\n        f = 0\n        for j in range(n):\n            if ls[i][j] < m:\n                s += ls[i][j]\n                m = ls[i][j]\n                f = 1\n                break\n        if f == 0:\n            d = 1\n            break\n    if d == 0:\n        print(s)\n    else:\n        print(-1)", "for u in range(int(input())):\n    n = int(input())\n    l = []\n    for i in range(n):\n        l.append(sorted(list(map(int, input().split())), reverse=True))\n    m = max(l[n - 1])\n    s = m\n    d = 0\n    for i in range(n - 2, -1, -1):\n        f = 0\n        for j in range(n):\n            if l[i][j] < m:\n                s += l[i][j]\n                m = l[i][j]\n                f = 1\n                break\n        if f == 0:\n            d = 1\n            break\n    if d == 0:\n        print(s)\n    else:\n        print(-1)", "def check(m, arr):\n    s = -1\n    for i in arr:\n        if i < m:\n            s = max(s, i)\n    return s\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = []\n    for i in range(n):\n        a.append(list(map(int, input().split())))\n    s = max(a[-1])\n    m = s\n    for i in range(n - 2, -1, -1):\n        m = check(m, a[i])\n        if m != -1:\n            s += m\n        else:\n            s = -1\n            break\n    print(s)", "def check(m, arr):\n    s = -1\n    for i in arr:\n        if i < m:\n            s = max(s, i)\n    return s\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = []\n    for i in range(n):\n        a.append(list(map(int, input().split())))\n    s = max(a[-1])\n    m = s\n    for i in range(n - 2, -1, -1):\n        m = check(m, a[i])\n        if m != -1:\n            s += m\n        else:\n            s = -1\n            break\n    print(s)", "for i in range(int(input())):\n    n = int(input())\n    rows = []\n    for i in range(n):\n        rows.append(list(map(int, input().split())))\n    c = max(rows[-1])\n    add = c\n    try:\n        for j in range(n - 2, -1, -1):\n            c = max([i for i in rows[j] if i < c])\n            add += c\n        print(add)\n    except ValueError:\n        print(-1)", "import numpy as np\nT = int(input())\nfor case in range(T):\n    n = int(input())\n    l = []\n    for i in range(n):\n        l.append(list(map(int, input().split())))\n    l.reverse()\n    ans = max(l[0])\n    m = max(l[0])\n    for i in range(1, n):\n        a = np.array(l[i])\n        a = a[a < m]\n        if len(a) == 0:\n            ans = -1\n            break\n        else:\n            m = max(a)\n            ans += m\n    print(ans)", "t = int(input())\nwhile t > 0:\n    l = []\n    n = int(input())\n    for i in range(n):\n        l.append(list(map(int, input().split())))\n    x = max(l[-1])\n    w = 0\n    s = x\n    for i in range(n - 2, -1, -1):\n        l[i].sort(reverse=True)\n        q = 0\n        for j in l[i]:\n            if j < x:\n                x = j\n                q = 1\n                s += x\n                break\n        if q == 0:\n            w = 1\n            print(-1)\n            break\n    if w == 0:\n        print(s)\n    t -= 1", "for _ in range(int(input())):\n    res = 0\n    mat = []\n    n = int(input())\n    for _ in range(n):\n        a = list(map(int, input().split()))\n        mat.append(sorted(a))\n    count = mat[n - 1][n - 1]\n    temp = mat[n - 1][n - 1]\n    c = 0\n    k = 0\n    for i in range(n - 2, -1, -1):\n        for j in range(n - 1, -1, -1):\n            if mat[i][j] < temp:\n                count += mat[i][j]\n                temp = mat[i][j]\n                c += 1\n                break\n        if c == 0:\n            print(-1)\n            k = 1\n            break\n        else:\n            c = 0\n    if k == 0:\n        print(count)", "t = int(input())\nwhile t:\n    n = int(input())\n    l = []\n    for i in range(n):\n        l1 = list(map(int, input().split()))\n        l1 = sorted(l1)\n        l.append(l1)\n    count = l[n - 1][n - 1]\n    m = l[n - 1][n - 1]\n    c = 0\n    k = 0\n    for i in range(n - 2, -1, -1):\n        for j in range(n - 1, -1, -1):\n            if l[i][j] < m:\n                count += l[i][j]\n                m = l[i][j]\n                c += 1\n                break\n        if c == 0:\n            print(-1)\n            k += 1\n            break\n        else:\n            c -= 1\n    if k == 0:\n        print(count)\n    t -= 1", "for _ in range(int(input())):\n    n = int(input())\n    l = []\n    while n > 0:\n        k = []\n        k = [int(i) for i in input().split()]\n        k = sorted(k)\n        l.append(k)\n        n -= 1\n    count = [l[-1][-1]]\n    flag = 0\n    for i in range(len(l) - 2, -1, -1):\n        for j in range(len(l) - 1, -1, -1):\n            if l[i][j] < count[-1]:\n                count.append(l[i][j])\n                break\n        else:\n            flag = 1\n            break\n        if flag == 1:\n            break\n    if flag == 1:\n        print(-1)\n    else:\n        print(sum(count))", "T = int(input())\nfor _ in range(T):\n    N = int(input())\n    l = []\n    for __ in range(N):\n        l.append(sorted(list(map(int, input().split()))))\n    M = l[N - 1][N - 1]\n    S = M\n    c = 0\n    f = 0\n    for i in range(N - 2, -1, -1):\n        for j in range(N - 1, -1, -1):\n            if l[i][j] < M:\n                M = l[i][j]\n                S += M\n                c += 1\n                break\n        if c == 0:\n            print('-1')\n            f += 1\n            break\n        else:\n            c -= 1\n    if f == 0:\n        print(S)", "import sys\n\ndef compute(x):\n    s = 0\n    temp = sys.maxsize\n    for i in range(len(x) - 1, -1, -1):\n        f = 0\n        for j in range(0, len(x)):\n            if x[i][j] > f and x[i][j] < temp:\n                f = x[i][j]\n        if f == 0:\n            return -1\n        temp = f\n        s += f\n    return s\nfor _ in range(int(input())):\n    n = int(input())\n    x = []\n    for _ in range(n):\n        x.append(list(map(int, input().split())))\n    print(compute(x))", "T = int(input())\nfor _ in range(T):\n    N = int(input())\n    l = []\n    S = 0\n    f = 0\n    for __ in range(N):\n        l.append(list(map(int, input().split())))\n    y = max(l[N - 1])\n    S += y\n    for i in range(N - 2, -1, -1):\n        c = 0\n        for j in range(0, N):\n            if l[i][j] > c and l[i][j] < y:\n                c = l[i][j]\n        if c == 0:\n            f += 1\n            break\n        else:\n            S += c\n            y = c\n    if f > 0:\n        print('-1')\n    else:\n        print(S)", "T = int(input())\nfor _ in range(T):\n    n = int(input())\n    seq = []\n    score_list = []\n    for _ in range(n):\n        res = list(map(int, input().split()))\n        seq.append(res)\n    seq.reverse()\n    for l in seq:\n        if len(score_list) == 0:\n            score_list.append(max(l))\n        else:\n            l.sort(reverse=True)\n            for i in l:\n                if i < score_list[len(score_list) - 1]:\n                    score_list.append(i)\n                    break\n                elif i == l[len(l) - 1] and i >= score_list[len(score_list) - 1]:\n                    score_list.append(-1)\n    if min(score_list) == -1:\n        print(-1)\n    else:\n        print(sum(score_list))", "for j in range(int(input())):\n    n = int(input())\n    x = []\n    for i in range(n):\n        y = list(map(int, input().split()))\n        y.sort()\n        x.append(y)\n    x.reverse()\n    z = []\n    a = max(x[0])\n    z.append(a)\n    v = 1\n    for i in range(1, n):\n        x[i].append(a)\n        x[i].sort()\n        b = x[i].index(a)\n        if b - 1 >= 0:\n            z.append(x[i][b - 1])\n            a = x[i][b - 1]\n        else:\n            v = 0\n            print(-1)\n            break\n    if v != 0:\n        print(sum(z))", "for j in range(int(input())):\n    n = int(input())\n    x = []\n    for i in range(n):\n        y = list(map(int, input().split()))\n        y.sort()\n        x.append(y)\n    x.reverse()\n    z = []\n    a = max(x[0])\n    z.append(a)\n    v = 1\n    for i in range(1, n):\n        x[i].append(a)\n        x[i].sort()\n        b = x[i].index(a)\n        if b - 1 >= 0:\n            z.append(x[i][b - 1])\n            a = x[i][b - 1]\n        else:\n            v = 0\n            print(-1)\n            break\n    if v != 0:\n        print(sum(z))", "for j in range(int(input())):\n    n = int(input())\n    x = []\n    for i in range(n):\n        y = list(map(int, input().split()))\n        y.sort()\n        x.append(y)\n    x.reverse()\n    z = []\n    a = max(x[0])\n    z.append(a)\n    v = 1\n    for i in range(1, n):\n        x[i].append(a)\n        x[i].sort()\n        b = x[i].index(a)\n        if b - 1 >= 0:\n            z.append(x[i][b - 1])\n            a = x[i][b - 1]\n        else:\n            v = 0\n            print(-1)\n            break\n    if v != 0:\n        print(sum(z))", "T = int(input())\nfor i in range(T):\n    N = int(input())\n    c = []\n    for j in range(N):\n        s = list(map(int, input().split()))\n        s.sort()\n        c.append(s)\n    t = 1\n    k = max(c[N - 1])\n    r = k\n    for i in range(N - 2, -1, -1):\n        for j in range(N - 1, -1, -1):\n            if k > c[i][j]:\n                k = c[i][j]\n                t += 1\n                r += k\n                break\n    if t == N:\n        print(r)\n    else:\n        print(-1)", "def fun(n, arr):\n    s = 0\n    temp = float('infinity')\n    for i in range(n - 1, -1, -1):\n        a = 0\n        for j in range(0, n):\n            if arr[i][j] > a and arr[i][j] < temp:\n                a = arr[i][j]\n        if a == 0:\n            return -1\n        temp = a\n        s += a\n    return s\nfor _ in range(int(input())):\n    n = int(input())\n    arr = [0] * n\n    for i in range(n):\n        arr[i] = list(map(int, input().strip().split()))\n    print(fun(n, arr))", "for _ in range(int(input())):\n    k = 0\n    x = int(input())\n    a = list()\n    p = [0] * x\n    for i in range(x):\n        a.append(list(map(int, input().split())))\n    p[-1] = max(a[-1])\n    flag = 0\n    for i in range(x - 2, -1, -1):\n        q = sorted(a[i])\n        m = 0\n        for j in range(x - 1, -1, -1):\n            if q[j] < p[i + 1]:\n                p[i] = q[j]\n                m = 1\n                break\n        if m == 0:\n            flag = 1\n            break\n    if flag == 1:\n        print(-1)\n    else:\n        print(sum(p))", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = []\n    for _ in range(n):\n        h = list(map(int, input().split()))\n        h.sort()\n        a.append(h)\n    c = 1\n    k = max(a[n - 1])\n    s = k\n    for i in range(n - 2, -1, -1):\n        for j in range(n - 1, -1, -1):\n            if k > a[i][j]:\n                k = a[i][j]\n                c += 1\n                s += k\n                break\n    if c == n:\n        print(s)\n    else:\n        print('-1')", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = []\n    for _ in range(n):\n        h = list(map(int, input().split()))\n        h.sort()\n        a.append(h)\n    c = 1\n    k = max(a[n - 1])\n    s = k\n    for i in range(n - 2, -1, -1):\n        for j in range(n - 1, -1, -1):\n            if k > a[i][j]:\n                k = a[i][j]\n                c += 1\n                s += k\n                break\n    if c == n:\n        print(s)\n    else:\n        print('-1')", "for _ in range(int(input())):\n    n = int(input())\n    lis = []\n    for i in range(n):\n        a = list(map(int, input().split()))\n        lis.append(a)\n    for i in range(n):\n        lis[i].sort()\n    sum = lis[n - 1][n - 1]\n    tmp = lis[n - 1][n - 1]\n    f = 0\n    g = 0\n    i = n - 2\n    while i >= 0:\n        j = n - 1\n        f = 0\n        while j >= 0:\n            if lis[i][j] < tmp:\n                sum += lis[i][j]\n                tmp = lis[i][j]\n                f = 1\n                break\n            j -= 1\n        if f == 0:\n            g = 1\n            break\n        i -= 1\n    if g == 0:\n        print(sum)\n    else:\n        print('-1')", "import sys\ninput = sys.stdin.readline\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = []\n    for i in range(n):\n        b = list(map(int, input().split()))\n        b.sort()\n        a.append(b)\n    ans = a[-1][-1]\n    flag = a[-1][-1]\n    for i in range(n - 2, -1, -1):\n        flag1 = 1\n        for j in range(n - 1, -1, -1):\n            if a[i][j] < flag:\n                flag1 = 0\n                ans += a[i][j]\n                flag = a[i][j]\n                break\n        if flag1 == 1:\n            print(-1)\n            break\n    if flag1 != 1:\n        print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    l = []\n    for i in range(n):\n        a = list(map(int, input().split()))\n        a.sort(reverse=True)\n        l.append(a)\n    su = l[n - 1][0]\n    flag = True\n    c = l[n - 1][0]\n    j = 0\n    if n > 1:\n        for i in range(n - 2, -1, -1):\n            j = 0\n            while 1:\n                if l[i][j] < su:\n                    su = l[i][j]\n                    c += l[i][j]\n                    break\n                elif j + 1 < n:\n                    j += 1\n                else:\n                    print(-1)\n                    flag = False\n                    break\n            if not flag:\n                break\n        if flag:\n            print(c)\n    elif n == 1:\n        print(c)", "tc = int(input().strip())\nfor t in range(tc):\n    n = int(input().strip())\n    arr = []\n    for i in range(n):\n        arr.append(list(map(int, input().strip().split())))\n    ans = 0\n    ulim = 1000000000.0 + 1\n    flag = True\n    for i in range(n - 1, -1, -1):\n        mx = -1\n        for j in range(n):\n            if ulim > arr[i][j]:\n                if arr[i][j] > mx:\n                    mx = arr[i][j]\n        if mx == -1:\n            flag = False\n            break\n        else:\n            ans += mx\n            ulim = mx\n    print(ans) if flag else print(-1)", "def fun(a, n):\n    t = max(a[n - 1])\n    s = 0\n    s += t\n    for i in range(n - 2, -1, -1):\n        l = []\n        for j in range(n):\n            if t > a[i][j]:\n                l.append(a[i][j])\n        if l == []:\n            return -1\n        t = max(l)\n        s += t\n    return s\nt = int(input())\nfor p in range(t):\n    n = int(input())\n    a = []\n    for i in range(n):\n        a.append(list(map(int, input().strip().split()))[:n])\n    print(fun(a, n))", "from bisect import bisect_left\nfor _ in range(int(input())):\n    N = int(input())\n    array = []\n    for i in range(N):\n        a = list(map(int, input().split()))\n        a.sort()\n        array.append(a)\n    sm = array[-1][-1]\n    current = array[-1][-1]\n    possible = True\n    for i in range(N - 2, -1, -1):\n        idx = bisect_left(array[i], current)\n        if idx == 0:\n            possible = False\n            break\n        else:\n            current = array[i][idx - 1]\n            sm += array[i][idx - 1]\n    if possible:\n        print(sm)\n    else:\n        print(-1)", "def maxsc(m, n):\n    from bisect import bisect_left\n    dp = [[-1 for _ in range(n)] for _ in range(n)]\n    for i in range(n):\n        dp[0][i] = m[0][i]\n    for i in range(1, n):\n        for j in range(n):\n            d = bisect_left(m[i - 1], m[i][j])\n            if d > 0 and dp[i - 1][d - 1] != -1:\n                dp[i][j] = max(dp[i][j], dp[i - 1][d - 1] + m[i][j])\n    return max(dp[n - 1])\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    m = []\n    for i in range(n):\n        L = list(map(int, input().split()))\n        m.append(sorted(L))\n    print(maxsc(m, n))", "for i in range(int(input())):\n    n = int(input())\n    l = []\n    for i in range(n):\n        x = list(map(int, input().split()))\n        l.append(x)\n    max1 = max(l[len(l) - 1])\n    sum1 = max1\n    c = len(l) - 2\n    while c >= 0:\n        z = l[c]\n        z.sort(reverse=True)\n        p = 0\n        for i in z:\n            if i < max1:\n                sum1 += i\n                max1 = i\n                p = 1\n                break\n        if p == 0:\n            sum1 = -1\n            break\n        c -= 1\n    print(sum1)", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    l = []\n    for i in range(0, n):\n        l1 = [int(l1) for l1 in input().split()]\n        l.append(l1)\n    s = max(l[-1])\n    m = max(l[-1])\n    g = 0\n    for i in range(n - 2, -1, -1):\n        m1 = -1\n        f = 0\n        for j in l[i]:\n            if j < m and j > m1:\n                f = 1\n                m1 = j\n        if f == 0:\n            print(-1)\n            g = 1\n            break\n        s += m1\n        m = m1\n    if g == 0:\n        print(s)", "for _ in range(int(input())):\n    n = int(input())\n    l = [[*map(int, input().split())] for i in range(n)]\n    for i in range(n):\n        l[i].sort()\n    val = l[-1][-1]\n    ans = val\n    flag = True\n    for i in range(n - 2, -1, -1):\n        j = n - 1\n        flag1 = False\n        while j >= 0:\n            if l[i][j] < val:\n                val = l[i][j]\n                flag1 = True\n                break\n            else:\n                j -= 1\n        if flag1:\n            ans += l[i][j]\n            val = l[i][j]\n        else:\n            flag = False\n            break\n    if flag:\n        print(ans)\n    else:\n        print(-1)", "t = int(input())\n\ndef func(n, l, cnt, cur):\n    for i in range(n - 2, -1, -1):\n        if min(l[i]) >= cur:\n            return -1\n            break\n        else:\n            l[i] = [k for k in l[i] if k < cur]\n            tmp = max(l[i])\n            cnt += tmp\n            cur = tmp\n    return cnt\nfor _ in range(t):\n    l = []\n    n = int(input())\n    for _ in range(n):\n        s = input().split(' ')\n        arr = [int(i) for i in s]\n        l.append(arr)\n    cnt = 0\n    cnt += max(l[-1])\n    cur = max(l[-1])\n    print(func(n, l, cnt, cur))", "def function(a, N):\n    acc = max(a[N - 1])\n    en = acc\n    for i in range(N - 2, -1, -1):\n        max_yet = -1\n        for elem in a[i]:\n            if elem > max_yet and elem < en:\n                max_yet = elem\n        if max_yet == -1:\n            print(-1)\n            return\n        en = max_yet\n        acc += en\n    print(acc)\nT = int(input())\nfor testcase in range(T):\n    N = int(input())\n    a = []\n    for i in range(N):\n        ai = list(map(int, input().split(' ')))\n        ai.sort()\n        a.append(ai)\n    function(a, N)", "def abc(l, n):\n    l.reverse()\n    x = l[0][-1]\n    sum = x\n    for i in range(1, n):\n        if l[i][0] >= x:\n            return -1\n        for j in range(n - 1, -1, -1):\n            if l[i][j] < x:\n                sum += l[i][j]\n                x = l[i][j]\n                break\n    return sum\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    l = []\n    for i in range(n):\n        x = list(map(int, input().split()))\n        x.sort()\n        l.append(x)\n    print(abc(l, n))", "for i in range(int(input())):\n    n = int(input())\n    b = []\n    counter = 0\n    for j in range(n):\n        b.append(list(map(int, input().split())))\n    c = max(b[-1])\n    sum = c\n    for k in range(1, n):\n        for x in b[-k - 1]:\n            if x < c and x > counter:\n                counter = x\n        if counter == 0:\n            print(-1)\n            sum = 0\n            break\n        else:\n            sum = sum + counter\n            c = counter\n            counter = 0\n    if sum != 0:\n        print(sum)", "for i in range(int(input())):\n    b = []\n    for j in range(int(input())):\n        a = [int(x) for x in input().split()]\n        b.append(a)\n    next = max(b[-1])\n    sum = next\n    for k in reversed(b[:-1]):\n        su = max((y if y < next else -1 for y in k))\n        if su == -1:\n            sum = -1\n            break\n        sum += su\n        next = su\n    print(sum)", "t = int(input())\nfor T in range(t):\n    l = []\n    n = int(input())\n    c = 1\n    for i in range(n):\n        a = [int(x) for x in input().split()]\n        a.sort()\n        l.append(a)\n    ans = l[n - 1][n - 1]\n    ele = ans\n    for i in range(len(l) - 2, -1, -1):\n        c = 1\n        for j in range(n - 1, -1, -1):\n            if l[i][j] < ele:\n                ele = l[i][j]\n                ans += ele\n                c = 0\n                break\n        if c == 1:\n            ans = -1\n            break\n    print(ans)"]