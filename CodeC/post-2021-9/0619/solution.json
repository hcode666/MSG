["for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    caso0 = [0 for i in range(n + 1)]\n    caso1 = [0 for i in range(n + 1)]\n    (n0, n1) = (-1, -1)\n    for i in range(n):\n        if i == 0:\n            caso0[i + 1] = 0\n            caso0[i + 1] = 0\n            if s[i] == '0':\n                n0 = i\n            else:\n                n1 = i\n        else:\n            caso0[i + 1] = n0 + 1\n            caso1[i + 1] = n1 + 1\n            if s[i] == '0':\n                n0 = i\n            else:\n                n1 = i\n    d = [0 for i in range(n)]\n    ans = 0\n    for i in range(n):\n        if i == 0:\n            d[i] = 1\n        elif s[i] == '1':\n            d[i] = 1 + d[i - 1]\n        else:\n            nex = caso1[caso1[caso0[i + 1]]]\n            d[i] = i - nex + 1\n        ans += d[i]\n    print(ans)", "def left_search(A, l, r, tag):\n    i = r\n    while i >= l and A[i] == tag:\n        i -= 1\n    return r - i\n\ndef backtrace(A):\n    (s, b) = (0, 0)\n    for r in range(len(A)):\n        if r == 0:\n            (s, b) = (1, 1)\n        else:\n            if A[r - 1] == '0' and A[r] == '1' or (A[r - 1] == A[r] and A[r] == '1'):\n                b += 1\n            elif A[r - 1] == A[r] and A[r] == '0':\n                if r + 1 < 3:\n                    b = 2\n                elif A[r - 2] == '0':\n                    b += 1\n                else:\n                    i = 3\n                    i += left_search(A, 0, r - i, '0')\n                    b = i\n            else:\n                i = 2\n                i += left_search(A, 0, r - i, '1')\n                i += left_search(A, 0, r - i, '0')\n                if i < r + 1:\n                    i += 1\n                i += left_search(A, 0, r - i, '0')\n                b = i\n            s += b\n    return s\nt = int(input())\nwhile t > 0:\n    n = int(input())\n    ba = input()\n    (full_zero, full_one) = (True, True)\n    for x in ba:\n        if x == '1':\n            full_zero = False\n    for x in ba:\n        if x == '0':\n            full_one = False\n    if full_one or full_zero:\n        print(len(ba) * (len(ba) + 1) // 2)\n    else:\n        ans = backtrace(ba)\n        print(ans)\n    t -= 1", "for i in range(int(input())):\n    N = int(input())\n    s = str(input())\n    ans = 0\n    x = y = z = w = N\n    for j in reversed(range(N)):\n        if s[j] == '1':\n            a = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    a.append(k)\n            if len(a) > 1:\n                z = a[0]\n                w = a[1]\n            elif len(a) == 1:\n                w = z\n                z = a[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "for i in range(int(input())):\n    N = int(input())\n    s = str(input())\n    ans = 0\n    x = y = z = w = N\n    for j in reversed(range(N)):\n        if s[j] == '1':\n            a = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    a.append(k)\n            if len(a) > 1:\n                z = a[0]\n                w = a[1]\n            elif len(a) == 1:\n                w = z\n                z = a[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "for i in range(int(input())):\n    N = int(input())\n    s = str(input())\n    ans = 0\n    x = y = z = w = N\n    for j in reversed(range(N)):\n        if s[j] == '1':\n            a = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    a.append(k)\n            if len(a) > 1:\n                z = a[0]\n                w = a[1]\n            elif len(a) == 1:\n                w = z\n                z = a[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    caso0 = [0 for i in range(n + 1)]\n    caso1 = [0 for i in range(n + 1)]\n    (n0, n1) = (-1, -1)\n    for i in range(n):\n        if i == 0:\n            caso0[i + 1] = 0\n            caso0[i + 1] = 0\n            if s[i] == '0':\n                n0 = i\n            else:\n                n1 = i\n        else:\n            caso0[i + 1] = n0 + 1\n            caso1[i + 1] = n1 + 1\n            if s[i] == '0':\n                n0 = i\n            else:\n                n1 = i\n    d = [0 for i in range(n)]\n    ans = 0\n    for i in range(n):\n        if i == 0:\n            d[i] = 1\n        elif s[i] == '1':\n            d[i] = 1 + d[i - 1]\n        else:\n            nex = caso1[caso1[caso0[i + 1]]]\n            d[i] = i - nex + 1\n        ans += d[i]\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    near0 = [0 for i in range(n + 1)]\n    near1 = [0 for i in range(n + 1)]\n    (n0, n1) = (-1, -1)\n    for i in range(n):\n        if i == 0:\n            near0[i + 1] = 0\n            near0[i + 1] = 0\n            if s[i] == '0':\n                n0 = i\n            else:\n                n1 = i\n        else:\n            near0[i + 1] = n0 + 1\n            near1[i + 1] = n1 + 1\n            if s[i] == '0':\n                n0 = i\n            else:\n                n1 = i\n    dp = [0 for i in range(n)]\n    ans = 0\n    for i in range(n):\n        if i == 0:\n            dp[i] = 1\n        elif s[i] == '1':\n            dp[i] = 1 + dp[i - 1]\n        else:\n            nxt = near1[near1[near0[i + 1]]]\n            dp[i] = i - nxt + 1\n        ans += dp[i]\n    print(ans)", "t = int(input())\nfor i in range(t):\n    N = int(input())\n    s = str(input())\n    ans = 0\n    x = y = z = w = N\n    for j in reversed(range(N)):\n        if s[j] == '1':\n            a = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    a.append(k)\n            if len(a) > 1:\n                z = a[0]\n                w = a[1]\n            elif len(a) == 1:\n                w = z\n                z = a[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "t = int(input())\nfor i in range(t):\n    n = int(input())\n    s = str(input())\n    ans = 0\n    x = y = z = w = n\n    for j in reversed(range(n)):\n        if s[j] == '1':\n            ze = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    ze.append(k)\n            if len(ze) > 1:\n                z = ze[0]\n                w = ze[1]\n            elif len(ze) == 1:\n                w = z\n                z = ze[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "t = int(input())\nfor i in range(t):\n    n = int(input())\n    s = str(input())\n    ans = 0\n    x = y = z = w = n\n    for j in reversed(range(n)):\n        if s[j] == '1':\n            ze = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    ze.append(k)\n            if len(ze) > 1:\n                z = ze[0]\n                w = ze[1]\n            elif len(ze) == 1:\n                w = z\n                z = ze[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "T = int(input())\nfor _ in range(T):\n    N = int(input())\n    S = input()\n    res = 0\n    W = X = Y = Z = N\n    for i in reversed(range(N)):\n        if S[i] == '1':\n            L = []\n            for j in range(X, Y):\n                if S[j] == '0':\n                    L.append(j)\n            if len(L) > 1:\n                Z = L[0]\n                W = L[1]\n            elif len(L) == 1:\n                W = Z\n                Z = L[0]\n            Y = X\n            X = i\n        res += W - i\n    print(res)", "T = int(input())\nfor _ in range(T):\n    N = int(input())\n    S = input()\n    res = 0\n    W = X = Y = Z = N\n    for i in reversed(range(N)):\n        if S[i] == '1':\n            L = []\n            for j in range(X, Y):\n                if S[j] == '0':\n                    L.append(j)\n            if len(L) > 1:\n                Z = L[0]\n                W = L[1]\n            elif len(L) == 1:\n                W = Z\n                Z = L[0]\n            Y = X\n            X = i\n        res += W - i\n    print(res)", "T = int(input())\nfor _ in range(T):\n    N = int(input())\n    S = input()\n    res = 0\n    W = X = Y = Z = N\n    for i in reversed(range(N)):\n        if S[i] == '1':\n            L = []\n            for j in range(X, Y):\n                if S[j] == '0':\n                    L.append(j)\n            if len(L) > 1:\n                Z = L[0]\n                W = L[1]\n            elif len(L) == 1:\n                W = Z\n                Z = L[0]\n            Y = X\n            X = i\n        res += W - i\n    print(res)", "T = int(input())\nfor _ in range(T):\n    N = int(input())\n    S = input()\n    res = 0\n    W = X = Y = Z = N\n    for i in reversed(range(N)):\n        if S[i] == '1':\n            L = []\n            for j in range(X, Y):\n                if S[j] == '0':\n                    L.append(j)\n            if len(L) > 1:\n                Z = L[0]\n                W = L[1]\n            elif len(L) == 1:\n                W = Z\n                Z = L[0]\n            Y = X\n            X = i\n        res += W - i\n    print(res)", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    s = input()\n    res = 0\n    w = x = y = z = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            l = []\n            for j in range(x, y):\n                if s[j] == '0':\n                    l.append(j)\n            if len(l) > 1:\n                z = l[0]\n                w = l[1]\n            elif len(l) == 1:\n                w = z\n                z = l[0]\n            y = x\n            x = i\n        res += w - i\n    print(res)", "T = int(input())\nfor i in range(T):\n    n = int(input())\n    s = input()\n    ans = 0\n    x = y = z = w = n\n    for j in reversed(range(n)):\n        if s[j] == '1':\n            ze = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    ze.append(k)\n            if len(ze) > 1:\n                z = ze[0]\n                w = ze[1]\n            elif len(ze) == 1:\n                w = z\n                z = ze[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "T = int(input())\nfor i in range(T):\n    n = int(input())\n    s = input()\n    ans = 0\n    x = y = z = w = n\n    for j in reversed(range(n)):\n        if s[j] == '1':\n            ze = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    ze.append(k)\n            if len(ze) > 1:\n                z = ze[0]\n                w = ze[1]\n            elif len(ze) == 1:\n                w = z\n                z = ze[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "T = int(input())\nfor i in range(T):\n    n = int(input())\n    s = input()\n    ans = 0\n    x = y = z = w = n\n    for j in reversed(range(n)):\n        if s[j] == '1':\n            ze = []\n            for k in range(x, y):\n                if s[k] == '0':\n                    ze.append(k)\n            if len(ze) > 1:\n                z = ze[0]\n                w = ze[1]\n            elif len(ze) == 1:\n                w = z\n                z = ze[0]\n            y = x\n            x = j\n        ans += w - j\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    near0 = [0 for i in range(n + 1)]\n    near1 = [0 for i in range(n + 1)]\n    (n0, n1) = (-1, -1)\n    for i in range(n):\n        if i == 0:\n            near0[i + 1] = 0\n            near0[i + 1] = 0\n            if s[i] == '0':\n                n0 = i\n            else:\n                n1 = i\n        else:\n            near0[i + 1] = n0 + 1\n            near1[i + 1] = n1 + 1\n            if s[i] == '0':\n                n0 = i\n            else:\n                n1 = i\n    dp = [0 for i in range(n)]\n    ans = 0\n    for i in range(n):\n        if i == 0:\n            dp[i] = 1\n        elif s[i] == '1':\n            dp[i] = 1 + dp[i - 1]\n        else:\n            nxt = near1[near1[near0[i + 1]]]\n            dp[i] = i - nxt + 1\n        ans += dp[i]\n    print(ans)", "for tea in range(int(input())):\n    n = int(input())\n    s = [0]\n    wow = list(input())\n    for i in wow:\n        s.append(int(i))\n    c = []\n    run = 0\n    curr = 0\n    for i in s:\n        if i == curr:\n            run += 1\n        else:\n            curr = i\n            c.append(run)\n            run = 1\n    c.append(run)\n    c[0] -= 1\n    ans = 0\n    for i in range(len(c)):\n        if i % 2 == 0:\n            ans += c[i] * (c[i] + 1) // 2\n            if i + 1 < len(c):\n                ans += c[i] * c[i + 1]\n                if i + 2 < len(c):\n                    if c[i + 1] > 1:\n                        ans += c[i]\n                        if i + 3 < len(c) and c[i + 2] == 1:\n                            ans += c[i] * c[i + 3]\n                    else:\n                        ans += c[i] * c[i + 2]\n                        if i + 3 < len(c):\n                            ans += c[i] * c[i + 3]\n                        if i + 4 < len(c):\n                            ans += c[i]\n                        if i + 5 < len(c) and c[i + 4] == 1:\n                            ans += c[i] * c[i + 5]\n        else:\n            ans += c[i] * (c[i] + 1) // 2\n            if i + 1 < len(c):\n                ans += c[i + 1] + c[i] - 1\n            if i + 2 < len(c):\n                if c[i + 1] == 1:\n                    ans += (c[i] - 1) * c[i + 2]\n                ans += c[i + 2]\n            if i + 3 < len(c):\n                ans += 1\n            if i + 4 < len(c) and c[i + 3] == 1:\n                ans += c[i + 4]\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 0\n    p1 = p2 = p3 = p4 = n\n    for i in reversed(range(n)):\n        if s[i] == '1':\n            zeros = []\n            for j in range(p1, p2):\n                if s[j] == '0':\n                    zeros.append(j)\n            if len(zeros) > 1:\n                p3 = zeros[0]\n                p4 = zeros[1]\n            elif len(zeros) == 1:\n                p4 = p3\n                p3 = zeros[0]\n            p2 = p1\n            p1 = i\n        ans += p4 - i\n    print(ans)", "for tea in range(int(input())):\n    n = int(input())\n    s = [0]\n    wow = list(input())\n    for i in wow:\n        s.append(int(i))\n    c = []\n    run = 0\n    curr = 0\n    for i in s:\n        if i == curr:\n            run += 1\n        else:\n            curr = i\n            c.append(run)\n            run = 1\n    c.append(run)\n    c[0] -= 1\n    ans = 0\n    for i in range(len(c)):\n        if i % 2 == 0:\n            ans += c[i] * (c[i] + 1) // 2\n            if i + 1 < len(c):\n                ans += c[i] * c[i + 1]\n                if i + 2 < len(c):\n                    if c[i + 1] > 1:\n                        ans += c[i]\n                        if i + 3 < len(c) and c[i + 2] == 1:\n                            ans += c[i] * c[i + 3]\n                    else:\n                        ans += c[i] * c[i + 2]\n                        if i + 3 < len(c):\n                            ans += c[i] * c[i + 3]\n                        if i + 4 < len(c):\n                            ans += c[i]\n                        if i + 5 < len(c) and c[i + 4] == 1:\n                            ans += c[i] * c[i + 5]\n        else:\n            ans += c[i] * (c[i] + 1) // 2\n            if i + 1 < len(c):\n                ans += c[i + 1] + c[i] - 1\n            if i + 2 < len(c):\n                if c[i + 1] == 1:\n                    ans += (c[i] - 1) * c[i + 2]\n                ans += c[i + 2]\n            if i + 3 < len(c):\n                ans += 1\n            if i + 4 < len(c) and c[i + 3] == 1:\n                ans += c[i + 4]\n    print(ans)"]