["import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmo = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    nu = 0\n    for i in range(l):\n        nu *= 2\n        nu += ord(ans[i]) - ord('0')\n        nu %= mo\n    print(nu)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmo = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    nu = 0\n    for i in range(l):\n        nu *= 2\n        nu += ord(ans[i]) - ord('0')\n        nu %= mo\n    print(nu)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmo = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    nu = 0\n    for i in range(l):\n        nu *= 2\n        nu += ord(ans[i]) - ord('0')\n        nu %= mo\n    print(nu)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmod = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    num = 0\n    for i in range(l):\n        num *= 2\n        num += ord(ans[i]) - ord('0')\n        num %= mod\n    print(num)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmod = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    num = 0\n    for i in range(l):\n        num *= 2\n        num += ord(ans[i]) - ord('0')\n        num %= mod\n    print(num)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmod = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    num = 0\n    for i in range(l):\n        num *= 2\n        num += ord(ans[i]) - ord('0')\n        num %= mod\n    print(num)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmod = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    num = 0\n    for i in range(l):\n        num *= 2\n        num += ord(ans[i]) - ord('0')\n        num %= mod\n    print(num)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmod = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    num = 0\n    for i in range(l):\n        num *= 2\n        num += ord(ans[i]) - ord('0')\n        num %= mod\n    print(num)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmod = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    num = 0\n    for i in range(l):\n        num *= 2\n        num += ord(ans[i]) - ord('0')\n        num %= mod\n    print(num)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmod = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    num = 0\n    for i in range(l):\n        num *= 2\n        num += ord(ans[i]) - ord('0')\n        num %= mod\n    print(num)", "import sys\ninput = sys.stdin.readline\nfrom bisect import bisect_left, bisect_right\nmod = 1000000007\nfor _ in range(int(input())):\n    n = int(input())\n    st = input().strip()\n    z = []\n    o = []\n    for i in range(n):\n        if st[i] == '0':\n            z.append(i)\n        else:\n            o.append(i)\n    for l in range(n // 2, 0, -1):\n        flag = False\n        for s in range(n - 2 * l + 1):\n            if st[s] == '0':\n                ind = bisect_left(o, s + l)\n                if ind != len(o) and o[ind] <= n - l:\n                    flag = True\n                    break\n            else:\n                ind = bisect_left(z, s + l)\n                if ind != len(z) and z[ind] <= n - l:\n                    flag = True\n                    break\n        if flag:\n            break\n    else:\n        print(0)\n        continue\n    ans = '0' * l\n    for s in range(n - 2 * l + 1):\n        for e in range(s + l, n - l + 1):\n            if st[s] != st[e]:\n                tans = ''\n                for i in range(l):\n                    if st[s + i] != st[e + i]:\n                        tans += '1'\n                    else:\n                        tans += '0'\n                if tans > ans:\n                    ans = tans\n    num = 0\n    for i in range(l):\n        num *= 2\n        num += ord(ans[i]) - ord('0')\n        num %= mod\n    print(num)"]